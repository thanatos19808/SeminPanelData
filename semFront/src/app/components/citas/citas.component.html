<app-navop></app-navop>
<div class="base">
<lib-ngx-notification></lib-ngx-notification>
<ngx-spinner></ngx-spinner>
    <div class="row">
        <div class="col-3 col-sm-3 col-md-3 col-lg-3 col-xl-3">
            <select  [(ngModel)]="sucursalSeleccionada" class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off" (change)="consultarDisponibilidadId()">
              <option [ngValue]=0 selected>Seleccionar Sucursal...</option>
              <option [ngValue]=2 >13 Sur (Matriz)</option>
              <option [ngValue]=3 >5 de Mayo</option>
              <option [ngValue]=4 >Xonaca</option>
              <option [ngValue]=6 >Chapultepec</option>
              <option [ngValue]=7 >Cruz del Sur</option>
              <option [ngValue]=8 >San Alejandro</option>
              <option [ngValue]=9 >La Margarita</option> 
              <option [ngValue]=10 >24 Sur</option>
              <option [ngValue]=11 >16 de Septiembre</option>
              <option [ngValue]=12 >Clínica Integral</option> 
              <option [ngValue]=13 >Amozoc</option>
          </select> 
        </div>
        <div *ngIf="sucursalSeleccionada == 0" class="col-4 col-sm-4 col-md-4 col-lg-4 col-xl-4">
            <select class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off" disabled>
              <option selected>Seleccionar Sala...</option>
            </select>
        </div>
        <div *ngIf="sucursalSeleccionada > 0" class="col-4 col-sm-4 col-md-4 col-lg-4 col-xl-4">
            <select [(ngModel)]="salaSeleccionada"  class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off" (change)="consultarCitasOp()">
              <option [ngValue]=0 selected>Seleccionar Sala...</option>
              <option *ngIf="disponibilidad.Sang > 0" [ngValue]=disponibilidad.Sang >Toma de Muestras Sanguíneas</option>
              <option *ngIf="disponibilidad.Esp > 0" [ngValue]=disponibilidad.Esp >Toma de Muestras Laboratorios Especiales</option>
              <option *ngIf="disponibilidad.US > 0" [ngValue]=disponibilidad.US >Ultrasonido</option>
              <option *ngIf="disponibilidad.RXS > 0" [ngValue]=disponibilidad.RXS >Rayos X Simples</option>
              <option *ngIf="disponibilidad.RXC > 0" [ngValue]=disponibilidad.RXC >Rayos X Contrastados</option>
              <option *ngIf="disponibilidad.Masto > 0" [ngValue]=disponibilidad.Masto >Mastografía</option>
              <option *ngIf="disponibilidad.TAC > 0" [ngValue]=disponibilidad.TAC >Tomografía computada</option>
              <option *ngIf="disponibilidad.RM > 0" [ngValue]=disponibilidad.RM >Resonancia Magnética</option>
              <option *ngIf="disponibilidad.Densi > 0" [ngValue]=disponibilidad.Densi >Densitometria</option>
              <option *ngIf="disponibilidad.Card > 0" [ngValue]=disponibilidad.Card >Cardiología</option>
              <option *ngIf="disponibilidad.Pato > 0" [ngValue]=disponibilidad.Pato >Patología</option>
              <option *ngIf="disponibilidad.Papa > 0" [ngValue]=disponibilidad.Papa >Papanicolaou</option>
              <option *ngIf="disponibilidad.Colpo > 0" [ngValue]=disponibilidad.Colpo >Colposcopía</option>
              <option *ngIf="disponibilidad.Cons1 > 0" [ngValue]=disponibilidad.Cons1 >Consultorio 1</option>
              <option *ngIf="disponibilidad.Cons2 > 0" [ngValue]=disponibilidad.Cons2 >Consultorio 2</option>
              <option *ngIf="disponibilidad.ConsReha > 0" [ngValue]=disponibilidad.ConsReha >Consultorio Rehabilitación</option>
              <option *ngIf="disponibilidad.Quir1 > 0" [ngValue]=disponibilidad.Quir1 >Qirófano 1</option>
              <option *ngIf="disponibilidad.Quir2 > 0" [ngValue]=disponibilidad.Quir2 >Qirófano 2</option>
              <option *ngIf="disponibilidad.Hab1 > 0" [ngValue]=disponibilidad.Hab1 >Habitación 1</option>
              <option *ngIf="disponibilidad.Hab2 > 0" [ngValue]=disponibilidad.Hab2 >Habitación 2</option>
              <option *ngIf="disponibilidad.Hab3 > 0" [ngValue]=disponibilidad.Hab3 >Habitación 3</option>
              <option *ngIf="disponibilidad.Hab4 > 0" [ngValue]=disponibilidad.Hab4 >Habitación 4</option>
              <option *ngIf="disponibilidad.Hab5 > 0" [ngValue]=disponibilidad.Hab5 >Habitación 5</option>
              <option *ngIf="disponibilidad.Hab6 > 0" [ngValue]=disponibilidad.Hab6 >Habitación 6</option>
              <option *ngIf="disponibilidad.Hab7 > 0" [ngValue]=disponibilidad.Hab7 >Habitación 7</option>
              <option *ngIf="disponibilidad.Exp1 > 0" [ngValue]=disponibilidad.Exp1 >Expulsión 1</option>
              <option *ngIf="disponibilidad.Inc1 > 0" [ngValue]=disponibilidad.Inc1 >Incubadora 1</option>
              <option *ngIf="disponibilidad.Inc2 > 0" [ngValue]=disponibilidad.Inc2 >Incubadora 2</option>
              <option *ngIf="disponibilidad.RehaEle1 > 0" [ngValue]=disponibilidad.RehaEle1 >Rehabilitación Electro 1</option>
              <option *ngIf="disponibilidad.RehaEle2 > 0" [ngValue]=disponibilidad.RehaEle2 >Rehabilitación Electro 2</option>
              <option *ngIf="disponibilidad.RehaEle3 > 0" [ngValue]=disponibilidad.RehaEle3 >Rehabilitación Electro 3</option>
              <option *ngIf="disponibilidad.RehaEle4 > 0" [ngValue]=disponibilidad.RehaEle4 >Rehabilitación Electro 4</option>
              <option *ngIf="disponibilidad.RehaEle5 > 0" [ngValue]=disponibilidad.RehaEle5 >Rehabilitación Electro 5</option>
              <option *ngIf="disponibilidad.RehaEle6 > 0" [ngValue]=disponibilidad.RehaEle6 >Rehabilitación Electro 6</option>
              <option *ngIf="disponibilidad.RehaEle7 > 0" [ngValue]=disponibilidad.RehaEle7 >Rehabilitación Electro 7</option>
              <option *ngIf="disponibilidad.RehaEle8 > 0" [ngValue]=disponibilidad.RehaEle8 >Rehabilitación Electro 8</option>
              <option *ngIf="disponibilidad.RehaHid1 > 0" [ngValue]=disponibilidad.RehaHid1 >Rehabilitación Hidroterapia 1</option>
              <option *ngIf="disponibilidad.RehaMec1 > 0" [ngValue]=disponibilidad.RehaMec1 >Rehabilitación Mecanoterapia  1</option>
              <option *ngIf="disponibilidad.ConsFis1 > 0" [ngValue]=disponibilidad.ConsFis1 >Consultorio Med. Física  1</option>
              <option *ngIf="disponibilidad.ConsFis2 > 0" [ngValue]=disponibilidad.ConsFis2 >Consultorio Med. Física  2</option>
              <option *ngIf="disponibilidad.ConsFis3 > 0" [ngValue]=disponibilidad.ConsFis3 >Consultorio Med. Física  3</option>
              <option *ngIf="disponibilidad.ConsPed > 0" [ngValue]=disponibilidad.ConsPed >Consultorio Pediatría  1</option>
              <option *ngIf="disponibilidad.ConsGineco > 0" [ngValue]=disponibilidad.ConsGineco >Consultorio Ginecología</option>
              <option *ngIf="disponibilidad.Covid > 0" [ngValue]=disponibilidad.Covid >Sala Covid</option>
              <option *ngIf="disponibilidad.Covid2 > 0" [ngValue]=disponibilidad.Covid2 >Sala Covid 2</option>
              <option *ngIf="disponibilidad.Audio > 0" [ngValue]=disponibilidad.Audio >Audiología</option>
              <option *ngIf="disponibilidad.ServDom1 > 0" [ngValue]=disponibilidad.ServDom1 >Serv. PCR Dom.</option>
              <option *ngIf="disponibilidad.ServDom2 > 0" [ngValue]=disponibilidad.ServDom2 >Serv. Ordinario Dom. </option>
              <option *ngIf="disponibilidad.ServDomRx > 0" [ngValue]=disponibilidad.ServDomRx >Serv. RX Dom.</option>
            </select>
            <br>
        </div>
        <div class="col-5 col-sm-5 col-md-5 col-lg-5 col-xl-5">
          <button *ngIf="salaSeleccionada > 0" type="button" class="btn boton pull-right" style="background-color: #394793; color: white; margin-top: 0px; padding-left: 9px; padding-right: 9px;" (click)="consultarCitasOp()">Actualizar</button> 
          <button *ngIf="salaSeleccionada == 0" type="button" class="btn boton pull-right" style="background-color: #394793; color: white; margin-top: 0px;  padding-left: 9px; padding-right: 9px;" disabled>Actualizar</button>
        </div >
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
          <br>
          <button *ngIf="salaSeleccionada > 0 && !empleado.auditor" type="button" class="btn boton" style="background-color: #394793; color: white;" (click)="purgarCitaTmp()" (click)="verEstudios(nuevaModal)">Nueva Cita</button>  
          <button *ngIf="salaSeleccionada == 0 || empleado.auditor" type="button" class="btn boton" style="background-color: #394793; color: white;" disabled>Nueva Cita</button>  
          &nbsp;&nbsp;&nbsp;&nbsp;
          <button *ngIf="salaSeleccionada > 0" type="button" class="btn boton" style="background-color: #394793; color: white;" (click)="consultarCitasBuscarOp()" (click)="verEstudios(buscarModal)">Buscar Cita</button>  
          <button *ngIf="salaSeleccionada == 0" type="button" class="btn boton" style="background-color: #394793; color: white;" disabled>Buscar Cita</button>  
          &nbsp;&nbsp;&nbsp;&nbsp;
          <button type="button" class="btn boton" style="background-color: #394793; color: white;" (click)="consultarCitasAbiertasOp()" (click)="verEstudios(abiertasModal)">Citas Abiertas</button>  
          &nbsp;&nbsp;&nbsp;&nbsp;
          <button type="button" class="btn boton" style="background-color: #394793; color: white;" (click)="consultarCitasExternasOp()" (click)="verEstudios(externasModal)">Citas Externas</button>  
          &nbsp;&nbsp;&nbsp;&nbsp;
          <button type="button" class="btn boton" style="background-color: #394793; color: white;" (click)="consultarCitasRembolsos()" (click)="verEstudios(rembolsosModal)">Rembolsos</button>  
          &nbsp;&nbsp;&nbsp;&nbsp;
          <button type="button" class="btn boton" style="background-color: #394793; color: white;" (click)="consultarFacturacion()" (click)="verEstudios(facturacionModal)">Facturación</button>  
          &nbsp;&nbsp;&nbsp;&nbsp;
          <button type="button" class="btn boton" style="background-color: #394793; color: white;"  (click)="verEstudios(callModal)">Call Center</button>  
          &nbsp;&nbsp;&nbsp;&nbsp;
          <button type="button" class="btn boton" style="background-color: #394793; color: white;"  (click)="consultarEstudioEmpresas()" (click)="verEstudios(empresaModal)">Empresas</button>  
        </div>
      </div >
    <br> 
    <br>
    <div *ngIf="salaSeleccionada==0">
      <span><a id="logo"><img class="logo" src="../../../../assets/img/logoBicolor.png"></a></span>
    </div>
    <h2 *ngIf="salaSeleccionada > 0" class="titulo" style="font-size: 2rem; text-align: center;">{{listaSucursales[sucursalSeleccionada]}} - Sala: {{salaSeleccionada}}</h2>
    <div class="invisible" [ngClass]="{'visible': salaSeleccionada > 0}" id="calendar"></div>
</div>

<div id="successModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->
    <div *ngIf="newCalendar==1"  class="modal-content scrollModal">
      <div class="modal-header">
        <div *ngIf="numCita!=null">
          <h4 *ngIf="citas.results[numCita].prueba" style="color:#9AB638; font-size: 25px;" class="modal-title">{{citas.results[numCita].prueba}}</h4>
        </div>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div *ngIf="numCita!=null" class="modal-body row">
        <div *ngIf="citas.results[numCita].tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
          <p ><strong>Número de cita: </strong>{{citas.results[numCita].id}}</p>
          <p ><strong>Fecha: </strong>{{citas.results[numCita].fecha_cita}}</p>
          <p><strong>Precio de Venta: </strong>{{citas.results[numCita].precioVenta}} MXN</p>
        </div>
        <div *ngIf="citas.results[numCita].tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
          <p><strong>Hora Inicio: </strong>{{citas.results[numCita].hora_inicio}}</p>
          <p><strong>Hora Final: </strong>{{citas.results[numCita].hora_final}}</p>
          <p *ngIf="citas.results[numCita].estatus=='ACTIVA'"><strong>Estatus: </strong><strong style="color:#9AB638;">{{citas.results[numCita].estatus}}</strong></p>
          <p *ngIf="citas.results[numCita].estatus=='CERRADA'"><strong>Estatus: </strong><strong style="color:#B2EBFE;">{{citas.results[numCita].estatus}}</strong></p>
          <p *ngIf="citas.results[numCita].estatus=='CARRITO'"><strong>Estatus: </strong><strong style="color:#E5BE01;">{{citas.results[numCita].estatus}}</strong></p>
          <p *ngIf="citas.results[numCita].estatus=='CANCELADA'"><strong>Estatus: </strong><strong style="color:#FF0000;">{{citas.results[numCita].estatus}}</strong></p>
        </div>
        <div *ngIf="citas.results[numCita].tipo_cita=='RESTRINGIDA'" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
          <h4  style="color:#9AB638; font-size: 25px;" class="modal-title">Tiempo Restringido</h4>
          <br>
          <p *ngIf="citaTmp.id"><strong>Id: </strong>{{citas.results[numCita].id}}</p>
          <p><strong>Hora Inicio: </strong>{{citas.results[numCita].hora_inicio}}</p>
          <p><strong>Hora Final: </strong>{{citas.results[numCita].hora_final}}</p>
          <p *ngIf="citas.results[numCita].estatus=='ACTIVA'"><strong>Estatus: </strong><strong style="color:#9AB638;">{{citas.results[numCita].estatus}}</strong></p>
          <p *ngIf="citas.results[numCita].estatus=='CERRADA'"><strong>Estatus: </strong><strong style="color:#B2EBFE;">{{citas.results[numCita].estatus}}</strong></p>
          <p *ngIf="citas.results[numCita].estatus=='CARRITO'"><strong>Estatus: </strong><strong style="color:#E5BE01;">{{citas.results[numCita].estatus}}</strong></p>
          <p *ngIf="citas.results[numCita].estatus=='CANCELADA'"><strong>Estatus: </strong><strong style="color:#FF0000;">{{citas.results[numCita].estatus}}</strong></p>
        </div>
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <hr>
        </div>
        <div *ngIf="citas.results[numCita].tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
          <p style="color:#9AB638; font-size: 20px;"><strong>Estatus de Pago: </strong></p>
          <p *ngIf="citas.results[numCita].id_pago"><strong>Identificador de Pago: </strong>{{citas.results[numCita].id_pago}}</p>
          <p *ngIf="!citas.results[numCita].id_pago"><strong>Identificador de Pago: </strong>No definido</p>
          <div *ngIf="citas.results[numCita].tipo_pago =='OPENPAY'" class="alert alert-success" role="alert">Esta cita fue pagada en Open Pay</div>
          <div *ngIf="citas.results[numCita].tipo_pago == 'PAYPAL'" class="alert alert-success" role="alert">Esta cita fue pagada en Pay Pal</div>
          <div *ngIf="citas.results[numCita].tipo_pago == 'STRIPE'" class="alert alert-success" role="alert">Esta cita fue pagada con tarjeta</div>
          <div *ngIf="!citas.results[numCita].id_pago" class="alert alert-warning" role="alert">Esta cita será pagada en Sucursal</div>
        </div>
        <div *ngIf="citas.results[numCita].tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
          <p style="color:#9AB638; font-size: 20px;"><strong>Registro: </strong></p>
          <p *ngIf="citas.results[numCita].creador"><strong>Creador: </strong>{{citas.results[numCita].creador}}</p>
          <p *ngIf="!citas.results[numCita].creador"><strong>Creador: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].editor"><strong>Última Edición: </strong>{{citas.results[numCita].editor}}</p>
          <p *ngIf="!citas.results[numCita].editor"><strong>Última Edición: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].creacion"><strong>Fecha Creación: </strong>{{citas.results[numCita].creacion.split('T')[0]}} {{citas.results[numCita].creacion.substring(11,19)}}</p>
          <p *ngIf="citas.results[numCita].ultimaActualizacion"><strong>Fecha Última Edición: </strong>{{citas.results[numCita].ultimaActualizacion.split('T')[0]}} {{citas.results[numCita].ultimaActualizacion.substring(11,19)}}</p>
        </div>
        <div *ngIf="citas.results[numCita].tipo_cita=='RESTRINGIDA'" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
          <p style="color:#9AB638; font-size: 20px;"><strong>Registro: </strong></p>
          <p *ngIf="citas.results[numCita].creador"><strong>Creador: </strong>{{citas.results[numCita].creador}}</p>
          <p *ngIf="!citas.results[numCita].creador"><strong>Creador: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].editor"><strong>Última Edición: </strong>{{citas.results[numCita].editor}}</p>
          <p *ngIf="!citas.results[numCita].editor"><strong>Última Edición: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].creacion"><strong>Fecha Creación: </strong>{{citas.results[numCita].creacion.split('T')[0]}} {{citas.results[numCita].creacion.substring(11,19)}}</p>
          <p *ngIf="citas.results[numCita].ultimaActualizacion"><strong>Fecha Última Edición: </strong>{{citas.results[numCita].ultimaActualizacion.split('T')[0]}} {{citas.results[numCita].ultimaActualizacion.substring(11,19)}}</p>
        </div> 
        <div *ngIf="citas.results[numCita].notas" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
          <hr>
          <p style="color:#9AB638; font-size: 20px;"><strong>Notas: </strong></p>
          <p>{{citas.results[numCita].notas}}</p>
        </div>          
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <hr>
        </div>
        <div *ngIf="citas.results[numCita].otro_nombre_paciente" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
          <p style="color:#9AB638; font-size: 20px;"><strong>El estudio es para otro paciente: </strong></p>
          <p ><strong>Nombre del paciente: </strong>{{citas.results[numCita].otro_nombre_paciente}}</p>
          <p ><strong>Fecha de nacimiento: </strong>{{citas.results[numCita].otro_fecha_nacimento}}</p>
          <p ><strong>Parentesco: </strong>{{citas.results[numCita].otro_parentesco_paciente}}</p>
        <hr>
        </div>  
        <div *ngIf="citas.results[numCita].Paciente" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
          <p style="color:#9AB638; font-size: 20px;"><strong>Paciente: </strong></p>
          <p *ngIf="citas.results[numCita].Paciente"><strong>Nombre: </strong>{{citas.results[numCita].Paciente.nombre}} {{citas.results[numCita].Paciente.apellido_paterno}} {{citas.results[numCita].Paciente.apellido_materno}} </p>
          <p *ngIf="citas.results[numCita].Paciente.sexo"><strong>Sexo: </strong>{{citas.results[numCita].Paciente.sexo}}</p>
          <p *ngIf="!citas.results[numCita].Paciente.sexo"><strong>Sexo: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].Paciente.discapacidad"><strong>Discapacidad: </strong>{{citas.results[numCita].Paciente.discapacidad}}</p>
          <p *ngIf="!citas.results[numCita].Paciente.discapacidad"><strong>Discapacidad: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].Paciente.tipo_sangre"><strong>Tipo de sangre: </strong>{{citas.results[numCita].Paciente.tipo_sangre}}</p>
          <p *ngIf="!citas.results[numCita].Paciente.tipo_sangre"><strong>Tipo de sangre: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].Paciente.fecha_nacimiento"><strong>Fecha de Nacimiento: </strong>{{citas.results[numCita].Paciente.fecha_nacimiento}}</p>
          <p *ngIf="!citas.results[numCita].Paciente.fecha_nacimiento"><strong>Fecha de Nacimiento: </strong>No definido</p>
        </div>  
        <div *ngIf="citas.results[numCita].Paciente" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
          <br><br>
          <p *ngIf="citas.results[numCita].Paciente.fecha_nacimiento && edadMeses > 11"><strong>Edad: </strong>{{edad}} años</p>
          <p *ngIf="citas.results[numCita].Paciente.fecha_nacimiento && edadMeses < 11"><strong>Edad: </strong>{{edadMeses}} meses</p>
          <p *ngIf="!citas.results[numCita].Paciente.fecha_nacimiento"><strong>Edad: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].Paciente.email"><strong>Correo: </strong>{{citas.results[numCita].Paciente.email}}</p>
          <p *ngIf="!citas.results[numCita].Paciente.email"><strong>Correo: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].Paciente.telefonoOficina"><strong>Tel. Oficina: </strong>{{citas.results[numCita].Paciente.telefonoOficina}}</p>
          <p *ngIf="!citas.results[numCita].Paciente.telefonoOficina"><strong>Tel. Oficina: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].Paciente.telefonoCasa"><strong>Tel. Casa: </strong>{{citas.results[numCita].Paciente.telefonoCasa}}</p>
          <p *ngIf="!citas.results[numCita].Paciente.telefonoCasa"><strong>Tel. Casa: </strong>No definido</p>
          <p *ngIf="citas.results[numCita].Paciente.telefonoCelular"><strong>Tel. Celular: </strong>{{citas.results[numCita].Paciente.telefonoCelular}}</p>
          <p *ngIf="!citas.results[numCita].Paciente.telefonoCelular"><strong>Tel. Celular: </strong>No definido</p>
        </div>
      </div>
      <div class="botones"> 
        <button type="button" class="btn btn-success" data-dismiss="modal" >Cerrar</button>
        <a *ngIf="editable && citas.results[numCita].tipo_cita!='RESTRINGIDA' && citas.results[numCita].estatus!='CARRITO'">&nbsp;&nbsp;&nbsp;&nbsp;</a>
        <button *ngIf="editable && citas.results[numCita].tipo_cita!='RESTRINGIDA' && citas.results[numCita].estatus!='CARRITO' && !empleado.auditor" type="button" class="btn btn-primary"  (click)="asignarValoresCita()" (click)="verEstudios(reagendarModal)">Reagendar</button>
        <button *ngIf="empleado.auditor" type="button" class="btn btn-primary"  disabled>Reagendar</button>
        <a *ngIf="editable">&nbsp;&nbsp;</a> 
        <button *ngIf="editable && citas.results[numCita].tipo_cita!='RESTRINGIDA' && !empleado.auditor" style="color:white; "type="button" class="btn btn-warning" (click)="idEstatus(citas.results[numCita].id)" (click)="verEstudios(estatusModal)">Modificar Estatus</button>
        <button *ngIf="editable && citas.results[numCita].tipo_cita=='RESTRINGIDA' && !empleado.auditor" style="color:white; "type="button" class="btn btn-warning" (click)="idEstatus(citas.results[numCita].id)" (click)="verEstudios(estatusRestringidaModal)">Modificar Estatus</button>
        <button *ngIf="empleado.auditor" style="color:white; "type="button" class="btn btn-warning" disabled>Modificar Estatus</button>
        <a *ngIf="editable">&nbsp;&nbsp;&nbsp;&nbsp;</a> 
        <button *ngIf="editable && !empleado.auditor" type="button" class="btn btn-success" (click)="rellenarCamposEditar()" (click)="verEstudios(editarModal)">Editar</button>
        <button *ngIf="empleado.auditor" type="button" class="btn btn-success" disabled>Editar</button>
      </div>
    </div>
  </div> 
</div>

<ng-template #reagendarModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Reagendar Cita</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
      <label>Sucursal (Requerida)</label>
      <select  [(ngModel)]="sucursalSeleccionadaTemp" class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off" (change)="consultarDisponibilidadIdTemp()">
        <option [ngValue]=0 >Seleccionar Sucursal..</option>
        <option [ngValue]=1 >Cholula</option>
        <option [ngValue]=2 >13 Sur (Matriz)</option>
        <option [ngValue]=3 >5 de Mayo</option>
        <option [ngValue]=4 >Xonaca</option>
        <option [ngValue]=6 >Chapultepec</option>
        <option [ngValue]=7 >Cruz del Sur</option>
        <option [ngValue]=8 >San Alejandro</option>
        <option [ngValue]=9 >La Margarita</option>
        <option [ngValue]=10 >24 Sur</option>
        <option [ngValue]=11 >16 de Septiembre</option>
        <option [ngValue]=12 >Clínica Integral</option>
        <option [ngValue]=13 >Amozoc</option>
      </select> 
    <br><br>
    </div>
    <div *ngIf="sucursalSeleccionadaTemp == 0" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
      <label>Sala (Requerida)</label>
      <select class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off" disabled>
        <option selected>Seleccionar Sala...</option>
      </select>
    </div>
    <div *ngIf="sucursalSeleccionadaTemp > 0" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
      <label>Sala (Requerida)</label>
      <select [(ngModel)]="salaSeleccionadaTemp"  class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off">
        <option [ngValue]=0 selected>Seleccionar Sala...</option>
        <option *ngIf="disponibilidadTemp.Sang > 0" [ngValue]=disponibilidadTemp.Sang >Toma de Muestras Sanguíneas</option>
        <option *ngIf="disponibilidadTemp.Esp > 0" [ngValue]=disponibilidadTemp.Esp >Toma de Muestras Laboratorios Especiales</option>
        <option *ngIf="disponibilidadTemp.US > 0" [ngValue]=disponibilidadTemp.US >Ultrasonido</option>
        <option *ngIf="disponibilidadTemp.RXS > 0" [ngValue]=disponibilidadTemp.RXS >Rayos X Simples</option>
        <option *ngIf="disponibilidadTemp.RXC > 0" [ngValue]=disponibilidadTemp.RXC >Rayos X Contrastados</option>
        <option *ngIf="disponibilidadTemp.Masto > 0" [ngValue]=disponibilidadTemp.Masto >Mastografía</option>
        <option *ngIf="disponibilidadTemp.TAC > 0" [ngValue]=disponibilidadTemp.TAC >Tomografía computada</option>
        <option *ngIf="disponibilidadTemp.RM > 0" [ngValue]=disponibilidadTemp.RM >Resonancia Magnética</option>
        <option *ngIf="disponibilidadTemp.Densi > 0" [ngValue]=disponibilidadTemp.Densi >Densitometria</option>
        <option *ngIf="disponibilidadTemp.Card > 0" [ngValue]=disponibilidadTemp.Card >Cardiología</option>
        <option *ngIf="disponibilidadTemp.Pato > 0" [ngValue]=disponibilidadTemp.Pato >Patología</option>
        <option *ngIf="disponibilidadTemp.Papa > 0" [ngValue]=disponibilidadTemp.Papa >Papanicolaou</option>
        <option *ngIf="disponibilidadTemp.Colpo > 0" [ngValue]=disponibilidadTemp.Colpo >Colposcopía</option>
        <option *ngIf="disponibilidadTemp.Cons1 > 0" [ngValue]=disponibilidadTemp.Cons1 >Consultorio 1</option>
        <option *ngIf="disponibilidadTemp.Cons2 > 0" [ngValue]=disponibilidadTemp.Cons2 >Consultorio 2</option>
        <option *ngIf="disponibilidadTemp.ConsGineco > 0" [ngValue]=disponibilidadTemp.ConsGineco >Consultorio Ginecologia</option>
        <option *ngIf="disponibilidadTemp.Quir1 > 0" [ngValue]=disponibilidadTemp.Quir1 >Qirófano 1</option>
        <option *ngIf="disponibilidadTemp.Quir2 > 0" [ngValue]=disponibilidadTemp.Quir2 >Qirófano 2</option>
        <option *ngIf="disponibilidadTemp.Hab1 > 0" [ngValue]=disponibilidadTemp.Hab1 >Habitación 1</option>
        <option *ngIf="disponibilidadTemp.Hab2 > 0" [ngValue]=disponibilidadTemp.Hab2 >Habitación 2</option>
        <option *ngIf="disponibilidadTemp.Hab3 > 0" [ngValue]=disponibilidadTemp.Hab3 >Habitación 3</option>
        <option *ngIf="disponibilidadTemp.Hab4 > 0" [ngValue]=disponibilidadTemp.Hab4 >Habitación 4</option>
        <option *ngIf="disponibilidadTemp.Hab5 > 0" [ngValue]=disponibilidadTemp.Hab5 >Habitación 5</option>
        <option *ngIf="disponibilidadTemp.Hab6 > 0" [ngValue]=disponibilidadTemp.Hab6 >Habitación 6</option>
        <option *ngIf="disponibilidadTemp.Hab7 > 0" [ngValue]=disponibilidadTemp.Hab7 >Habitación 7</option>
        <option *ngIf="disponibilidadTemp.Exp1 > 0" [ngValue]=disponibilidadTemp.Exp1 >Expulsion 1</option>
        <option *ngIf="disponibilidadTemp.Inc1 > 0" [ngValue]=disponibilidadTemp.Inc1 >Incubadora 1</option>
        <option *ngIf="disponibilidadTemp.Inc2 > 0" [ngValue]=disponibilidadTemp.Inc2 >Incubadora 2</option>
        <option *ngIf="disponibilidad.RehaEle1 > 0" [ngValue]=disponibilidad.RehaEle1 >Rehabilitación Electro 1</option>
        <option *ngIf="disponibilidad.RehaEle2 > 0" [ngValue]=disponibilidad.RehaEle2 >Rehabilitación Electro 2</option>
        <option *ngIf="disponibilidad.RehaEle3 > 0" [ngValue]=disponibilidad.RehaEle3 >Rehabilitación Electro 3</option>
        <option *ngIf="disponibilidad.RehaEle4 > 0" [ngValue]=disponibilidad.RehaEle4 >Rehabilitación Electro 4</option>
        <option *ngIf="disponibilidad.RehaEle5 > 0" [ngValue]=disponibilidad.RehaEle5 >Rehabilitación Electro 5</option>
        <option *ngIf="disponibilidad.RehaEle6 > 0" [ngValue]=disponibilidad.RehaEle6 >Rehabilitación Electro 6</option>
        <option *ngIf="disponibilidad.RehaEle7 > 0" [ngValue]=disponibilidad.RehaEle7 >Rehabilitación Electro 7</option>
        <option *ngIf="disponibilidad.RehaEle8 > 0" [ngValue]=disponibilidad.RehaEle8 >Rehabilitación Electro 8</option>
        <option *ngIf="disponibilidad.RehaHid1 > 0" [ngValue]=disponibilidad.RehaHid1 >Rehabilitación Hidroterapia 1</option>
        <option *ngIf="disponibilidad.RehaMec1 > 0" [ngValue]=disponibilidad.RehaMec1 >Rehabilitación Mecanoterapia  1</option>
      </select>
      <br><br> 
      <br><br>
    </div>
    <form [formGroup]="citaReagendarForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
      <label>Fecha de la cita (Requerido)</label>
      <br>
      <input class="form-control" id="date" type="date" formControlName="fecha_cita" [(ngModel)]="citaTmp.fecha_cita">
      <span style="color:Red;" *ngIf="citaReagendarForm.controls['fecha_cita'].errors?.minDate">Esta fecha no es válida</span>
      <span style="color:Red;" *ngIf="citaReagendarForm.controls['fecha_cita'].errors?.maxDate">Esta fecha no puede superar el año</span>
      <span style="color:Red;" *ngIf="citaReagendarForm.controls['fecha_cita'].touched && citaReagendarForm.controls['fecha_cita'].errors?.required">Campo Requerido.</span>
      <br>
      <label>Hora Inicio (Requerida)</label>
      <br>
      <input type="time" name="hora_inicio"  formControlName="hora_inicio"  [(ngModel)]="citaTmp.hora_inicio">
      <br>
      <span style="color:Red;" *ngIf="citaReagendarForm.controls['hora_inicio'].touched && citaReagendarForm.controls['hora_inicio'].errors?.required">Campo Requerido.</span>
      <br>
      <label>Hora Final (Requerida)</label>
      <br>
      <input type="time" name="hora_final"  formControlName="hora_final"  [(ngModel)]="citaTmp.hora_final">
      <br>
      <span style="color:Red;" *ngIf="citaReagendarForm.controls['hora_final'].touched && citaReagendarForm.controls['hora_final'].errors?.required">Campo Requerido.</span>
      <span style="color:Red;" *ngIf="citaReagendarForm.errors" > Por favor revise el horario ingresado</span>
      <br>
      <label>Notas</label>
      <input class="form-control" type="text" placeholder="Notas" formControlName="notas" [(ngModel)]="citaTmp.notas">
      <span style="color:Red;" *ngIf="citaReagendarForm.controls['notas'].errors?.minlength">Debe ser mayor a 5 caracteres</span>
      <span style="color:Red;" *ngIf="citaReagendarForm.controls['notas'].errors?.maxlength">No debe ser mayor a 500 caracteres</span>
      <br>
      <span style="color:Red;" *ngIf="citaReagendarForm.controls['notas'].errors?.pattern">No válido</span>
      <br>
    </form>
    <div *ngIf="citaEstatus==1" class="alert alert-primary" role="alert">Espere...</div>
    <div *ngIf="citaEstatus==2" class="alert alert-success" role="alert">Cita Reagendada Exitosamente</div>
    <div  *ngIf="citaEstatus==3" class="alert alert-danger" role="alert">Error: {{msgError}}</div>
    <button type="button" class="btn boton" (click)="c('')">Regresar</button>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <button *ngIf="sucursalSeleccionadaTemp > 0 && salaSeleccionadaTemp > 0" type="button"  class="btn boton" data-dismiss="modal" (click)="reagendarCita()" [disabled]="citaReagendarForm.invalid">Reagendar</button>
    <button  *ngIf="sucursalSeleccionadaTemp == 0 || salaSeleccionadaTemp == 0" type="button"  class="btn boton" data-dismiss="modal" disabled>Reagendar</button>
  </div>
</ng-template>

<ng-template #estatusRestringidaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Modificar Estatus</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->  
  <div class="modal-body">
      <select  [(ngModel)]="estatusSeleccionado" class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off">
        <option [ngValue]=0 selected>Seleccionar Estatus...</option>
        <option [ngValue]=2 >CANCELADA</option>
    </select>  
    <br *ngIf="estatusSeleccionado == 0">
    <div *ngIf="estatusSeleccionado == 1">
      <br>
      <h6 class="titulo" style="font-size: 20px; text-align: center;"> Al cerrarse una cita no podrá ser editada. ¿Desea Proceder?</h6>
    </div>
    <div *ngIf="estatusSeleccionado == 2">
      <br>
      <h6 class="titulo" style="font-size: 20px; text-align: center;"> Al cancelarse una cita no podrá ser editada. ¿Desea Proceder?</h6>
    </div> 
    <br>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button *ngIf="estatusSeleccionado==0" type="button"  class="btn boton" data-dismiss="modal" disabled>Modificar</button>
      <button *ngIf="estatusSeleccionado > 0" type="button" (click)="actualizarCitaEstatus()" (click)="c('')" class="btn boton" data-dismiss="modal">Modificar</button>
  </div>
</ng-template>

<ng-template #estatusModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Modificar Estatus</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->  
  <div class="modal-body">
      <select  [(ngModel)]="estatusSeleccionado" class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off">
        <option [ngValue]=0 selected>Seleccionar Estatus...</option>
        <option [ngValue]=1 >CERRADA</option>
        <option [ngValue]=2 >CANCELADA</option>
    </select>  
    <br *ngIf="estatusSeleccionado == 0">
    <div *ngIf="estatusSeleccionado == 1">
      <br>
      <h6 class="titulo" style="font-size: 20px; text-align: center;"> Al cerrarse una cita no podrá ser editada. ¿Desea Proceder?</h6>
    </div>
    <div *ngIf="estatusSeleccionado == 2">
      <br>
      <h6 class="titulo" style="font-size: 20px; text-align: center;"> Al cancelarse una cita no podrá ser editada. ¿Desea Proceder?</h6>
    </div> 
    <br>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button *ngIf="estatusSeleccionado==0" type="button"  class="btn boton" data-dismiss="modal" disabled>Modificar</button>
      <button *ngIf="estatusSeleccionado > 0" type="button" (click)="actualizarCitaEstatus()" (click)="c('')" class="btn boton" data-dismiss="modal">Modificar</button>
  </div>
</ng-template>

<ng-template #editarModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Editar Cita</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <form [formGroup]="citaEditarForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <label>Notas</label>
        <input class="form-control" type="text" placeholder="Notas" formControlName="notas" [(ngModel)]="notasTmp">
        <span style="color:Red;" *ngIf="citaEditarForm.controls['notas'].errors?.minlength">Debe ser mayor a 5 caracteres</span>
        <span style="color:Red;" *ngIf="citaEditarForm.controls['notas'].errors?.maxlength">No debe ser mayor a 500 caracteres</span>
        <span style="color:Red;" *ngIf="citaEditarForm.controls['notas'].touched && citaEditarForm.controls['notas'].errors?.required">Nombre Requerido.</span>
        <br>
        <span style="color:Red;" *ngIf="citaEditarForm.controls['notas'].errors?.pattern">No válido</span>
        <br>
    </form>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button"  class="btn boton" data-dismiss="modal"  (click)="c('')" (click)="editarCita()" [disabled]="citaEditarForm.invalid">Modificar</button>
  </div>
</ng-template>

<ng-template #editarRemModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Finalizar Rembolso</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <form [formGroup]="citaEditarForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <label>Notas</label>
        <input class="form-control" type="text" placeholder="Notas" formControlName="notas" [(ngModel)]="notasTmp">
        <span style="color:Red;" *ngIf="citaEditarForm.controls['notas'].errors?.minlength">Debe ser mayor a 5 caracteres</span>
        <br *ngIf="citaEditarForm.controls['notas'].errors?.minlength">
        <span style="color:Red;" *ngIf="citaEditarForm.controls['notas'].errors?.maxlength">No debe ser mayor a 500 caracteres</span>
        <br *ngIf="citaEditarForm.controls['notas'].errors?.maxlength">
        <span style="color:Red;" *ngIf="citaEditarForm.controls['notas'].touched && citaEditarForm.controls['notas'].errors?.required">Nombre Requerido.</span>
        <br *ngIf="citaEditarForm.controls['notas'].touched && citaEditarForm.controls['notas'].errors?.required">
        <br>
        <span style="color:Red;" *ngIf="citaEditarForm.controls['notas'].errors?.pattern">No válido</span>
        <label>Estatus de Rembolso</label>
        <select  [(ngModel)]="estatusRemSeleccionado" class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off" [ngModelOptions]="{standalone: true}">
          <option [ngValue]=0 selected>Seleccionar Estatus...</option>
          <option [ngValue]=1 >APROBADO</option>
          <option [ngValue]=2 >RECHAZADO</option>
          <option [ngValue]=3 >CANCELAR SOLICITUD</option>
        </select> 
        <br><br>
    </form>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button *ngIf="estatusRemSeleccionado==0" type="button"  class="btn boton" data-dismiss="modal"  disabled>Modificar</button>
      <button *ngIf="estatusRemSeleccionado" type="button"  class="btn boton" data-dismiss="modal"  (click)="c('')" (click)="editarCita()"[disabled]="citaEditarForm.invalid">Modificar</button>
    </div>
</ng-template>


<ng-template #citaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">{{citaTmp.prueba}}</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div class="row">
      <div *ngIf="citaTmp.tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p><strong>Número de cita: </strong>{{citaTmp.id}}</p>
        <p><strong>Fecha: </strong>{{citaTmp.fecha_cita}}</p>
        <p><strong>Precio de Venta: </strong>{{citaTmp.precioVenta}} MXN</p>
      </div>
      <div *ngIf="citaTmp.tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p *ngIf="citaTmp.hora_inicio"><strong>Hora Inicio: </strong>{{citaTmp.hora_inicio}}</p>
        <p *ngIf="!citaTmp.hora_inicio"><strong>Hora Inicio: </strong>No definido</p>
        <p *ngIf="citaTmp.hora_final"><strong>Hora Final: </strong>{{citaTmp.hora_final}}</p>
        <p *ngIf="!citaTmp.hora_final"><strong>Hora Final: </strong>No definido</p>
        <p *ngIf="citaTmp.estatus=='ACTIVA'"><strong>Estatus: </strong><strong style="color:#9AB638;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CERRADA'"><strong>Estatus: </strong><strong style="color:#B2EBFE;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CARRITO'"><strong>Estatus: </strong><strong style="color:#E5BE01;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CANCELADA'"><strong>Estatus: </strong><strong style="color:#FF0000;">{{citaTmp.estatus}}</strong></p>
      </div>
      <div *ngIf="citaTmp.tipo_cita=='RESTRINGIDA'" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <h4  style="color:#9AB638; font-size: 25px;" class="modal-title">Tiempo Restringido:</h4>
        <br>
        <p *ngIf="citaTmp.id"><strong>Id: </strong>{{citaTmp.id}}</p>
        <p *ngIf="citaTmp.hora_inicio"><strong>Hora Inicio: </strong>{{citaTmp.hora_inicio}}</p>
        <p *ngIf="!citaTmp.hora_inicio"><strong>Hora Inicio: </strong>No definido</p>
        <p *ngIf="citaTmp.hora_final"><strong>Hora Final: </strong>{{citaTmp.hora_final}}</p>
        <p *ngIf="!citaTmp.hora_final"><strong>Hora Final: </strong>No definido</p>
        <p *ngIf="citaTmp.estatus=='ACTIVA'"><strong>Estatus: </strong><strong style="color:#9AB638;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CERRADA'"><strong>Estatus: </strong><strong style="color:#B2EBFE;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CARRITO'"><strong>Estatus: </strong><strong style="color:#E5BE01;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CANCELADA'"><strong>Estatus: </strong><strong style="color:#FF0000;">{{citaTmp.estatus}}</strong></p>
      </div>
      <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <hr>
      </div>
      <div *ngIf="citaTmp.tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p style="color:#9AB638; font-size: 20px;"><strong>Estatus de Pago: </strong></p>
        <p *ngIf="citaTmp.id_pago"><strong>Identificador de Pago: </strong>{{citaTmp.id_pago}}</p>
        <p *ngIf="!citaTmp.id_pago"><strong>Identificador de Pago: </strong>No definido</p>
        <div *ngIf="citaTmp.tipo_pago =='OPENPAY'" class="alert alert-success" role="alert">Esta cita fue pagada en Open Pay</div>
        <div *ngIf="citaTmp.tipo_pago == 'PAYPAL'" class="alert alert-success" role="alert">Esta cita fue pagada en Pay Pal</div>
        <div *ngIf="citaTmp.tipo_pago == 'STRIPE'" class="alert alert-success" role="alert">Esta cita fue pagada con tarjeta</div>
        <div *ngIf="!citaTmp.id_pago" class="alert alert-warning" role="alert">Esta cita será pagada en Sucursal</div>
      </div>
      <div *ngIf="citaTmp.tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p style="color:#9AB638; font-size: 20px;"><strong>Registro: </strong></p>
        <p *ngIf="citaTmp.creador"><strong>Creador: </strong>{{citaTmp.creador}}</p>
        <p *ngIf="!citaTmp.creador"><strong>Creador: </strong>No definido</p>
        <p *ngIf="citaTmp.editor"><strong>Última Edición: </strong>{{citaTmp.editor}}</p>
        <p *ngIf="!citaTmp.editor"><strong>Última Edición: </strong>No definido</p>        
        <p *ngIf="citaTmp.creacion"><strong>Fecha Creación: </strong>{{citaTmp.creacion.split('T')[0]}} {{citaTmp.creacion.substring(11,19)}}</p>
        <p *ngIf="citaTmp.ultimaActualizacion"><strong>Fecha Última Edición: </strong>{{citaTmp.ultimaActualizacion.split('T')[0]}} {{citaTmp.ultimaActualizacion.substring(11,19)}}</p>
      </div>
      <div *ngIf="citaTmp.tipo_cita=='RESTRINGIDA'" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <p style="color:#9AB638; font-size: 20px;"><strong>Registro: </strong></p>
        <p *ngIf="citaTmp.creador"><strong>Creador: </strong>{{citaTmp.creador}}</p>
        <p *ngIf="!citaTmp.creador"><strong>Creador: </strong>No definido</p>
        <p *ngIf="citaTmp.editor"><strong>Última Edición: </strong>{{citaTmp.editor}}</p>
        <p *ngIf="!citaTmp.editor"><strong>Última Edición: </strong>No definido</p>
        <p *ngIf="citaTmp.creacion"><strong>Fecha Creación: </strong>{{citaTmp.creacion.split('T')[0]}} {{citaTmp.creacion.substring(11,19)}}</p>
        <p *ngIf="citaTmp.ultimaActualizacion"><strong>Fecha Última Edición: </strong>{{citaTmp.ultimaActualizacion.split('T')[0]}} {{citaTmp.ultimaActualizacion.substring(11,19)}}</p>
      </div>
      <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <hr>
      </div>
      <div *ngIf="citaTmp.notas" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <p style="color:#9AB638; font-size: 20px;"><strong>Notas: </strong></p>
        <p>{{citaTmp.notas}}</p>
        <hr>
      </div>        
      <div *ngIf="citaTmp.otro_nombre_paciente" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <p style="color:#9AB638; font-size: 20px;"><strong>El estudio es para otro paciente: </strong></p>
        <p ><strong>Nombre del paciente: </strong>{{citaTmp.otro_nombre_paciente}}</p>
        <p ><strong>Fecha de nacimiento: </strong>{{citaTmp.otro_fecha_nacimento}}</p>
        <p ><strong>Parentesco: </strong>{{citaTmp.otro_parentesco_paciente}}</p>
      <hr>
      </div>  
      <div *ngIf="citaTmp.Paciente" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p style="color:#9AB638; font-size: 20px;"><strong>Paciente: </strong></p>
        <p *ngIf="citaTmp.Paciente"><strong>Nombre: </strong>{{citaTmp.Paciente.nombre}} {{citaTmp.Paciente.apellido_paterno}} {{citaTmp.Paciente.apellido_materno}} </p>
        <p *ngIf="citaTmp.Paciente.sexo"><strong>Sexo: </strong>{{citaTmp.Paciente.sexo}}</p>
        <p *ngIf="!citaTmp.Paciente.sexo"><strong>Sexo: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.discapacidad"><strong>Discapacidad: </strong>{{citaTmp.Paciente.discapacidad}}</p>
        <p *ngIf="!citaTmp.Paciente.discapacidad"><strong>Discapacidad: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.tipo_sangre"><strong>Tipo de sangre: </strong>{{citaTmp.Paciente.tipo_sangre}}</p>
        <p *ngIf="!citaTmp.Paciente.tipo_sangre"><strong>Tipo de sangre: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.fecha_nacimiento"><strong>Fecha de Nacimiento: </strong>{{citaTmp.Paciente.fecha_nacimiento}} </p>
        <p *ngIf="!citaTmp.Paciente.fecha_nacimiento"><strong>Fecha de Nacimiento: </strong>No definido </p>
      </div>  
      <div *ngIf="citaTmp.Paciente" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <br><br>
        <p *ngIf="citaTmp.Paciente.fecha_nacimiento && edadMeses > 11"><strong>Edad: </strong>{{edad}} años</p>
        <p *ngIf="citaTmp.Paciente.fecha_nacimiento && edadMeses < 11"><strong>Edad: </strong>{{edadMeses}} meses</p>
        <p *ngIf="!citaTmp.Paciente.fecha_nacimiento"><strong>Edad: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.email"><strong>Correo: </strong>{{citaTmp.Paciente.email}}</p>
        <p *ngIf="!citaTmp.Paciente.email"><strong>Correo: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.telefonoOficina"><strong>Tel. Oficina: </strong>{{citaTmp.Paciente.telefonoOficina}}</p>
        <p *ngIf="!citaTmp.Paciente.telefonoOficina"><strong>Tel. Oficina: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.telefonoCasa"><strong>Tel. Casa: </strong>{{citaTmp.Paciente.telefonoCasa}}</p>
        <p *ngIf="!citaTmp.Paciente.telefonoCasa"><strong>Tel. Casa: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.telefonoCelular"><strong>Tel. Celular: </strong>{{citaTmp.Paciente.telefonoCelular}}</p>
        <p *ngIf="!citaTmp.Paciente.telefonoCelular"><strong>Tel. Celular: </strong>No definido</p>
      </div>
    </div>
    <div class="botones">
      <button type="button" class="btn btn-success" data-dismiss="modal" (click)="c('')">Cerrar</button> 
      <a>&nbsp;&nbsp;&nbsp;&nbsp;</a>
      <button *ngIf="citaTmp.tipo_cita!='RESTRINGIDA' && citaTmp.tipo_cita != 'EXTERNA' && citaTmp.estatus=='ACTIVA' && !empleado.auditor" type="button" class="btn btn-primary"  (click)="asignarValoresCita()" (click)="verEstudios(reagendarModal)">Reagendar</button>
      <button *ngIf="empleado.auditor" type="button" class="btn btn-primary"  disabled>Reagendar</button>
      <a *ngIf="citaTmp.estatus=='ACTIVA'">&nbsp;&nbsp;&nbsp;&nbsp;</a> 
      <a *ngIf="citaTmp.tipo_cita!='RESTRINGIDA' && citaTmp.tipo_cita != 'EXTERNA' && citaTmp.estatus=='ACTIVA'">&nbsp;&nbsp;&nbsp;&nbsp;</a> 
      <button *ngIf="citaTmp.estatus=='ACTIVA' && !empleado.auditor" style="color:white; "type="button" class="btn btn-warning" (click)="idEstatus(citaTmp.id)" (click)="verEstudios(estatusModal)">Modificar Estatus</button>
      <button *ngIf="empleado.auditor" style="color:white; "type="button" class="btn btn-warning" disabled>Modificar Estatus</button>
      <a *ngIf="citaTmp.estatus=='ACTIVA'">&nbsp;&nbsp;&nbsp;&nbsp;</a> 
      <button *ngIf="citaTmp.estatus=='ACTIVA' && !empleado.auditor" type="button" class="btn btn-success" (click)="rellenarCamposEditar()" (click)="verEstudiosEditar(editarModal)">Editar</button>
      <button *ngIf="empleado.auditor" type="button" class="btn btn-success" disabled>Editar</button>
    </div>
  </div>
</ng-template>



<ng-template #facturaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Factura</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div *ngIf="factura"> 
      <div class="row">       
        <div class="col-12 col-sm-12 col-md-6 col-lg-4 col-xl-4" >
          <p>Id. Factura: <strong>{{factura.id}}</strong></p>
          <p>Empresa: <strong style="color:#FF0000;">{{factura.empresa}}</strong></p>
          <p *ngIf="factura.sucursal">Sucursal: <strong style="color:#FF0000;">{{factura.sucursal}}</strong></p>
          <p *ngIf="!factura.sucursal">Sucursal: <strong style="color:#FF0000;">No definido</strong></p>
          <p *ngIf="factura.Paciente">Solicitada por Paciente: <strong style="color:#9AB638;"> SI</strong></p>
          <p *ngIf="factura.Paciente">Id. Paciente Solicitante: <strong style="color:#9AB638;">{{factura.Paciente}}</strong></p>
          <p *ngIf="!factura.Paciente">Solicitada por Paciente: <strong style="color:#FF0000;">NO</strong></p>
          <p *ngIf="factura.nombre_paciente">Nombre Paciente: <strong >{{factura.nombre_paciente}}</strong></p>
          <p *ngIf="!factura.nombre_paciente">Nombre Paciente: <strong >No definido</strong></p>
          <p *ngIf="factura.factura_estatus=='SOLICITADO'" (click)="copyText(factura.factura_estatus)">Estatus: <strong style="color:#B2EBFE;">{{factura.factura_estatus}}</strong></p>
          <p *ngIf="factura.factura_estatus=='APROBADO'" (click)="copyText(factura.factura_estatus)">Estatus: <strong style="color:#9AB638;">{{factura.factura_estatus}}</strong></p>
          <p *ngIf="factura.factura_estatus=='RECHAZADO'" (click)="copyText(factura.factura_estatus)">Estatus: <strong style="color:#FF0000;">{{factura.factura_estatus}}</strong></p>
          <p (click)="copyName()">Nombre: <strong>{{factura.nombre}}</strong></p>
          <p (click)="copyName()">Apellido Paterno: <strong>{{factura.apellido_paterno}}</strong></p>
          <p (click)="copyName()">Apellido Materno: <strong>{{factura.apellido_materno}}</strong></p>
          <p *ngIf="factura.tipo_rfc=='FISICA'" (click)="copyText(factura.tipo_rfc)">Tipo RFC: <strong style="color:#9AB638;">{{factura.tipo_rfc}}</strong></p>
          <p *ngIf="factura.tipo_rfc=='MORAL'" (click)="copyText(factura.tipo_rfc)">Tipo RFC: <strong style="color:#FF0000;">{{factura.tipo_rfc}}</strong></p>
          <p (click)="copyText(factura.rfc)">RFC: <strong>{{factura.rfc}}</strong></p>
          <p (click)="copyText(factura.cantidad_pagada)">Cantidad Pagada: <strong>{{factura.cantidad_pagada}}</strong></p>                
          <p (click)="copyText(((factura.cantidad_pagada/1.16)).toFixed(3))">Cantidad Pagada (IVA): <strong>{{((factura.cantidad_pagada/1.16)).toFixed(3)}}</strong></p>                 
        </div>   
        <div class="col-12 col-sm-12 col-md-6 col-lg-4 col-xl-4" >
          <p *ngIf="factura.calle" (click)="copyText(factura.calle)">Calle: <strong>{{factura.calle}}</strong></p>
          <p *ngIf="!factura.calle">Calle: <strong>No definido</strong></p>
          <p *ngIf="factura.colonia" (click)="copyText(factura.colonia)">Colonia: <strong>{{factura.colonia}}</strong></p>
          <p *ngIf="!factura.colonia">Colonia: <strong>No definido</strong></p>
          <p *ngIf="factura.num_interior" (click)="copyText(factura.num_interior)">Num. Interior: <strong>{{factura.num_interior}}</strong></p>
          <p *ngIf="!factura.num_interior">Num. Interior: <strong>No definido</strong></p>
          <p *ngIf="factura.num_exterior" (click)="copyText(factura.num_exterior)">Num. Exterior: <strong>{{factura.num_exterior}}</strong></p>
          <p *ngIf="!factura.num_exterior">Num. Exterior: <strong>No definido</strong></p>
          <p *ngIf="factura.cp" (click)="copyText(factura.cp)">Cp: <strong>{{factura.cp}}</strong></p>
          <p *ngIf="!factura.cp">Cp: <strong>No definido</strong></p>
          <p *ngIf="factura.municipio" (click)="copyText(factura.municipio)">Municipio: <strong>{{factura.municipio}}</strong></p>
          <p *ngIf="!factura.municipio">Municipio: <strong>No definido</strong></p>
          <p *ngIf="factura.localidad" (click)="copyText(factura.localidad)">Localidad: <strong>{{factura.localidad}}</strong></p>
          <p *ngIf="!factura.localidad">Localidad: <strong>No definido</strong></p>
          <p *ngIf="factura.estado" (click)="copyText(factura.estado)">Estado: <strong>{{factura.estado}}</strong></p>
          <p *ngIf="!factura.estado">Estado: <strong>No definido</strong></p>
          <p *ngIf="factura.telefono" (click)="copyText(factura.telefono)">Teléfono: <strong>{{factura.telefono}}</strong></p>
          <p *ngIf="!factura.telefono">Teléfono: <strong>No definido</strong></p>
          <p *ngIf="factura.email" (click)="copyText(factura.email)">Email: <strong>{{factura.email}}</strong></p>
          <p *ngIf="!factura.email">Email: <strong>No definido</strong></p>                 
        </div>  
        <div class="col-12 col-sm-12 col-md-6 col-lg-4 col-xl-4" >              
          <p *ngIf="factura.cfdi_uso" (click)="copyText(factura.cfdi_uso)">Uso CFDI: <strong>{{factura.cfdi_uso}}</strong></p>
          <p *ngIf="!factura.cfdi_uso">Uso CFDI: <strong>No definido</strong></p>
          <p *ngIf="factura.forma_pago" (click)="copyText(factura.forma_pago)">Forma de Pago: <strong>{{factura.forma_pago}}</strong></p>
          <p *ngIf="!factura.forma_pago">Forma de Pago: <strong>No definido</strong></p>
          <p *ngIf="factura.metodo_pago" (click)="copyText(factura.metodo_pago)">Método de Pago: <strong>{{factura.metodo_pago}}</strong></p>
          <p *ngIf="!factura.metodo_pago">Método de Pago: <strong>No definido</strong></p>
          <p *ngIf="factura.descripcion" (click)="copyText(factura.descripcion)">Descripción: <strong>{{factura.descripcion}}</strong></p>
          <p *ngIf="!factura.descripcion">Descripción: <strong>No definido</strong></p>
          <p *ngIf="factura.analisis_clinicos" (click)="copyText(factura.analisis_clinicos)">Análisis_clínicos: <strong>{{factura.analisis_clinicos}}</strong></p>
          <p *ngIf="!factura.analisis_clinicos">Análisis_clínicos: <strong>No definido</strong></p>
          <p *ngIf="factura.nombre_estudio" (click)="copyText(factura.nombre_estudio)">Nombre de Estudio: <strong>{{factura.nombre_estudio}}</strong></p>
          <p *ngIf="!factura.nombre_estudio">Nombre de Estudio: <strong>No definido</strong></p>
          <p *ngIf="factura.descripcion_servicios" (click)="copyText(factura.descripcion_servicios)">Descripción de Servicios: <strong>{{factura.descripcion_servicios}}</strong></p>
          <p *ngIf="!factura.descripcion_servicios">Descripción de Servicios: <strong>No definido</strong></p>
          <p *ngIf="factura.num_expediente" (click)="copyText(factura.num_expediente)">Num. de Expediente: <strong>{{factura.num_expediente}}</strong></p>
          <p *ngIf="!factura.num_expediente">Num. de Expediente: <strong>No definido</strong></p>
          <p *ngIf="factura.num_folio" (click)="copyText(factura.num_folio)">Num. de Folio: <strong>{{factura.num_folio}}</strong></p>
          <p *ngIf="!factura.num_folio">Num. de Folio: <strong>No definido</strong></p>               
        </div> 
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" >
          <hr>
          <p *ngIf="factura.estudios_realizados" (click)="copyText(factura.estudios_realizados)">Estudios Realizados: <strong>{{factura.estudios_realizados}}</strong></p>
          <p *ngIf="!factura.estudios_realizados">Estudios Realizados: <strong>No definido</strong></p>                     
        </div>
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" >
          <hr>
          <p *ngIf="factura.observaciones" (click)="copyText(factura.observaciones)">Observaciones: <strong>{{factura.observaciones}}</strong></p>
          <p *ngIf="!factura.observaciones">Observaciones: <strong>No definido</strong></p>
        </div> 
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" >
          <hr>
          <p *ngIf="factura.creador">Creador: <strong>{{factura.creador}}</strong></p>
          <p *ngIf="!factura.creador">Creador: <strong>No definido</strong></p>
          <p *ngIf="factura.editor">Editor: <strong>{{factura.editor}}</strong></p>
          <p *ngIf="!factura.editor">Editor: <strong>No definido</strong></p>
          <p *ngIf="factura.creacion">Creación: <strong>{{factura.creacion.substring(0,10)}} {{factura.creacion.substring(11,16)}}</strong></p>
          <p *ngIf="!factura.creacion">Creación: <strong>No definido</strong></p>
          <p *ngIf="factura.ultimaActualizacion">Última Actualización: <strong>{{factura.ultimaActualizacion.substring(0,10)}} {{factura.ultimaActualizacion.substring(11,16)}}</strong></p>
          <p *ngIf="!factura.ultimaActualizacion">Última Actualización: <strong>No definido</strong></p>                     
        </div>     
      </div>
    </div>
    <div class="botones">
      <button type="button" class="btn btn-success" data-dismiss="modal" (click)="c('')">Cerrar</button>
      <a>&nbsp;&nbsp;&nbsp;&nbsp;</a>
      <button type="button" *ngIf="!empleado.auditor" style="color:white;" class="btn btn-warning" (click)="asignarValoresFactura()" (click)="verEstudios(finalizarFacturaModal)">Finalizar Factura</button>
      <button type="button" *ngIf="empleado.auditor" style="color:white;" class="btn btn-warning" disabled>Finalizar Factura</button>
    </div>
  </div>
</ng-template>


<ng-template #finalizarFacturaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Finalizar Factura</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <form [formGroup]="facturaEstatusForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <label>Notas</label>
        <input class="form-control" type="text" placeholder="Notas" formControlName="observaciones" [(ngModel)]="facturaTmp.observaciones">
        <span style="color:Red;" *ngIf="facturaEstatusForm.controls['observaciones'].errors?.maxlength">No debe ser mayor a 1,000 caracteres</span>
        <br *ngIf="facturaEstatusForm.controls['observaciones'].errors?.maxlength">
        <span style="color:Red;" *ngIf="facturaEstatusForm.controls['observaciones'].errors?.pattern">No válido</span>
        <br *ngIf="facturaEstatusForm.controls['observaciones'].errors?.pattern">
        <br>
        <label>Estatus de Rembolso</label>
        <select  [(ngModel)]="estatusFacSeleccionado" class="custom-select mr-sm-2" id="inlineFormCustomSelect" autocomplete="off" [ngModelOptions]="{standalone: true}">
          <option [ngValue]=0 selected>Seleccionar Estatus...</option>
          <option [ngValue]=1 >APROBADO</option>
          <option [ngValue]=2 >RECHAZADO</option>
        </select> 
        <br><br>
      </form>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button *ngIf="estatusFacSeleccionado==0" type="button"  class="btn boton" data-dismiss="modal"  disabled>Modificar</button>
      <button *ngIf="estatusFacSeleccionado" type="button"  class="btn boton" data-dismiss="modal"  (click)="c('')" (click)="editarEstatusFactura()" [disabled]="facturaEstatusForm.invalid">Modificar</button>
    </div>
</ng-template>

<ng-template #nuevaFacturaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Solicitar Factura</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div class="row">
      <form [formGroup]="FacturacionCrearForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> 
        <label class="editar" >Empresa (Requerido)</label>
        <select class="form-control" id="empresa" formControlName="empresa" [(ngModel)]="facturaTmp.empresa">
          <option [ngValue]="'Semin'"selected>Semín</option>
          <option [ngValue]="'SPT'">Salud Para Todos</option>
        </select>
        <div *ngIf="facturaTmp.empresa">
          <br *ngIf="FacturacionCrearForm.controls['sucursal'].touched && FacturacionCrearForm.controls['sucursal'].errors?.required">
          <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['sucursal'].touched && FacturacionCrearForm.controls['sucursal'].errors?.required">Requerido.</span>
        </div>
        <br>
        <label class="editar" >Sucursal (Requerido)</label>
        <select class="form-control" id="sucursal" formControlName="sucursal" [(ngModel)]="facturaTmp.sucursal">
          <option selected>Cholula</option>
          <option>13 Sur (Matriz)</option>
          <option>5 de Mayo</option>
          <option>Xonaca</option>
          <option>Chapultepec</option>
          <option>Cruz del Sur</option>
          <option>San Alejandro</option>
          <option>La Margarita</option>
          <option>24 Sur</option>
          <option>16 de Septiembre</option>
          <option>Clínica Integral</option>
          <option>Amozoc</option>
          <option>Cholula</option>
          <option>105 Pte</option>
        </select>
        <br>
        <div *ngIf="facturaTmp.empresa">
          <span  style="color:Red;" *ngIf="FacturacionCrearForm.controls['sucursal'].touched && FacturacionCrearForm.controls['sucursal'].errors?.required">Requerido.</span>
          <br *ngIf="FacturacionCrearForm.controls['sucursal'].touched && FacturacionCrearForm.controls['sucursal'].errors?.required"> 
        </div>
        <label class="editar" >Nombre (Requerido)</label>
        <input class="form-control" type="text" placeholder="Nombre" formControlName="nombre"  autocomplete="off" [(ngModel)]="facturaTmp.nombre">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['nombre'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['nombre'].errors?.minlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['nombre'].errors?.maxlength">No debe ser de mas de 90 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['nombre'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['nombre'].touched && FacturacionCrearForm.controls['nombre'].errors?.required">Nombre Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['nombre'].touched && FacturacionCrearForm.controls['nombre'].errors?.required">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['nombre'].errors?.pattern">No parece ser un nombre válido</span>
        <br *ngIf="FacturacionCrearForm.controls['nombre'].errors?.pattern">
        <br>
        <label class="editar">Apellido Paterno (Requerido)</label>
        <input class="form-control" type="text" placeholder="Primer Apellido" formControlName="apellido_paterno" [(ngModel)]="facturaTmp.apellido_paterno">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['apellido_paterno'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['apellido_paterno'].errors?.minlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['apellido_paterno'].errors?.maxlength">No debe ser de mas de 45 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['apellido_paterno'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['apellido_paterno'].touched && FacturacionCrearForm.controls['apellido_paterno'].errors?.required">Apellido Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['apellido_paterno'].touched && FacturacionCrearForm.controls['apellido_paterno'].errors?.required">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['apellido_paterno'].errors?.pattern">No parece ser un apellido válido</span>
        <br *ngIf="FacturacionCrearForm.controls['apellido_paterno'].errors?.pattern">
        <br>
        <label class="editar">Apellido Materno</label>
        <input class="form-control" type="text" placeholder="Segundo Apellido" formControlName="apellido_materno" [(ngModel)]="facturaTmp.apellido_materno">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['apellido_materno'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['apellido_materno'].errors?.minlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['apellido_materno'].errors?.maxlength">No debe ser de mas de 45 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['apellido_materno'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['apellido_materno'].errors?.pattern">No parece ser un apellido válido</span>
        <br *ngIf="FacturacionCrearForm.controls['apellido_materno'].errors?.pattern">
        <br>
        <label>RFC (Requerido)</label>
        <input class="form-control" type="text" placeholder="RFC" formControlName="rfc" [(ngModel)]="facturaTmp.rfc">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['rfc'].errors?.minlength">EL RFC debe tener mas de 12 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['rfc'].errors?.minlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['rfc'].errors?.maxlength">EL RFC debe tener menos de 14 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['rfc'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['rfc'].touched && FacturacionCrearForm.controls['rfc'].errors?.required">Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['rfc'].touched && FacturacionCrearForm.controls['rfc'].errors?.required">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['rfc'].errors?.pattern">No parece ser un RFC válido</span>
        <br *ngIf="FacturacionCrearForm.controls['rfc'].errors?.pattern">
        <br>
        <label>Cantidad Pagada (Requerido)</label>
        <input class="form-control" type="number" onkeydown="javascript: return event.keyCode == 69 ? false : true" placeholder="Cantidad Pagada" formControlName="cantidad_pagada" [(ngModel)]="facturaTmp.cantidad_pagada">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['cantidad_pagada'].errors?.min">Cantidad no válida</span>
        <br *ngIf="FacturacionCrearForm.controls['cantidad_pagada'].errors?.min">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['cantidad_pagada'].errors?.max">Cantidad no válida</span>
        <br *ngIf="FacturacionCrearForm.controls['cantidad_pagada'].errors?.max">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['cantidad_pagada'].touched && FacturacionCrearForm.controls['cantidad_pagada'].errors?.required">Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['cantidad_pagada'].touched && FacturacionCrearForm.controls['cantidad_pagada'].errors?.required">
        <br>
        <label>Teléfono (Requerido)</label>
        <input class="form-control" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" placeholder="" formControlName="telefono" [(ngModel)]="facturaTmp.telefono">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['telefono'].errors?.min">Número no válido</span>
        <br *ngIf="FacturacionCrearForm.controls['telefono'].errors?.min">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['telefono'].errors?.max">Número no válido</span>
        <br *ngIf="FacturacionCrearForm.controls['telefono'].errors?.max">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['telefono'].touched && FacturacionCrearForm.controls['telefono'].errors?.required">Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['telefono'].touched && FacturacionCrearForm.controls['telefono'].errors?.required">     
        <br>  
        <label>Correo (Requerido)</label>
        <input autocomplete="off" type="email" id="email" name="email" class="form-control" placeholder="Correo" [(ngModel)]="facturaTmp.email" formControlName="email">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['email'].touched && FacturacionCrearForm.controls['email'].errors?.required">Correo es Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['email'].touched && FacturacionCrearForm.controls['email'].errors?.required">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['email'].errors?.minlength">El correo debe tener mínimo 5 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['email'].errors?.minlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['email'].errors?.maxlength">El correo no puede superar los 40 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['email'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['email'].errors?.pattern">No parece ser un correo válido</span>   
        <br *ngIf="FacturacionCrearForm.controls['email'].errors?.pattern">
        <br>
        <label for="cfdi_uso" class="editar">Uso CFDI (Requerido)</label>
        <select class="form-control" id="cfdi_uso" formControlName="cfdi_uso" [(ngModel)]="facturaTmp.cfdi_uso">
          <option>P01-Por definir</option>
          <option>G03-Gastos en general</option> 
          <option>D01-Honorarios medicos dentales y gastos hospitalarios</option>
        </select>
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['cfdi_uso'].touched && FacturacionCrearForm.controls['cfdi_uso'].errors?.required">Requerido.</span>
        <br>
        <label for="forma_pago" class="editar">Forma de Pago (Requerido)</label>
        <select class="form-control" id="forma_pago" formControlName="forma_pago" [(ngModel)]="facturaTmp.forma_pago">
          <option>01-Efectivo</option>
          <option>03-Transferencia electrónica de fondos</option>
          <option>04-Tarjeta de crédito</option>
          <option>28-Tarjeta de debito</option> 
          <option>99-Por definir</option>
        </select>
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['forma_pago'].touched && FacturacionCrearForm.controls['forma_pago'].errors?.required">Requerido.</span>
        <br>
        <label for="metodo_pago" class="editar">Método de Pago (Requerido)</label>
        <select class="form-control" id="metodo_pago" formControlName="metodo_pago" [(ngModel)]="facturaTmp.metodo_pago">
          <option>PDD-Pago en parcialidades o diferido</option>
          <option>PUE-Pago en una sola exhibición</option>
        </select>
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['metodo_pago'].touched && FacturacionCrearForm.controls['metodo_pago'].errors?.required">Requerido.</span>
        <br>
        <label>Descripción (Requerido)</label>
        <input class="form-control" type="text" placeholder="Descripción" formControlName="descripcion" [(ngModel)]="facturaTmp.descripcion">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['descripcion'].errors?.minlength">Descripción debe tener al menos 5 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['descripcion'].errors?.minlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['descripcion'].errors?.maxlength">Descripción debe tener menos de 1000 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['descripcion'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['descripcion'].errors?.pattern">No válido</span>
        <br *ngIf="FacturacionCrearForm.controls['descripcion'].errors?.pattern">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['descripcion'].touched && FacturacionCrearForm.controls['descripcion'].errors?.required">Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['descripcion'].touched && FacturacionCrearForm.controls['descripcion'].errors?.required">
        <br>
        <label>Nombre del Paciente (Requerido)</label>
        <input class="form-control" type="text" placeholder="Nombre de Paciente" formControlName="nombre_paciente" [(ngModel)]="facturaTmp.nombre_paciente">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['nombre_paciente'].errors?.minlength">Nombre de Paciente debe tener al menos 5 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['nombre_paciente'].errors?.minlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['nombre_paciente'].errors?.maxlength">Nombre de Paciente debe tener menos de 150 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['nombre_paciente'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['nombre_paciente'].errors?.pattern">No válido</span>
        <br *ngIf="FacturacionCrearForm.controls['nombre_paciente'].errors?.pattern">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['nombre_paciente'].touched && FacturacionCrearForm.controls['nombre_paciente'].errors?.required">Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['nombre_paciente'].touched && FacturacionCrearForm.controls['nombre_paciente'].errors?.required">
        <br>
        <label>Num. de Expediente (Requerido)</label>
        <input class="form-control" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" placeholder="" formControlName="num_expediente" [(ngModel)]="facturaTmp.num_expediente">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['num_expediente'].errors?.min">Número no válido</span>
        <br *ngIf="FacturacionCrearForm.controls['num_expediente'].errors?.min">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['num_expediente'].errors?.max">Número no válido</span>
        <br *ngIf="FacturacionCrearForm.controls['num_expediente'].errors?.max">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['num_expediente'].touched && FacturacionCrearForm.controls['num_expediente'].errors?.required">Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['num_expediente'].touched && FacturacionCrearForm.controls['num_expediente'].errors?.required">     
        <br>
        <label>Num. de Folio (Requerido)</label>
        <input class="form-control" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" placeholder="" formControlName="num_folio" [(ngModel)]="facturaTmp.num_folio">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['num_folio'].errors?.min">Número no válido</span>
        <br *ngIf="FacturacionCrearForm.controls['num_folio'].errors?.min">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['num_folio'].errors?.max">Número no válido</span>
        <br *ngIf="FacturacionCrearForm.controls['num_folio'].errors?.max">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['num_folio'].touched && FacturacionCrearForm.controls['num_folio'].errors?.required">Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['num_folio'].touched && FacturacionCrearForm.controls['num_folio'].errors?.required">     
        <br>
        <label>Estudios Realizados (Requerido)</label>
        <input class="form-control" type="text" placeholder="Estudios Realizados" formControlName="estudios_realizados" [(ngModel)]="facturaTmp.estudios_realizados">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['estudios_realizados'].errors?.minlength">Estudios Realizados debe tener al menos 5 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['estudios_realizados'].errors?.minlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['estudios_realizados'].errors?.maxlength">Estudios Realizados debe tener menos de 1000 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['estudios_realizados'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['estudios_realizados'].errors?.pattern">No válido</span>
        <br *ngIf="FacturacionCrearForm.controls['estudios_realizados'].errors?.pattern">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['estudios_realizados'].touched && FacturacionCrearForm.controls['estudios_realizados'].errors?.required">Requerido.</span>
        <br *ngIf="FacturacionCrearForm.controls['estudios_realizados'].touched && FacturacionCrearForm.controls['estudios_realizados'].errors?.required">
        <br>
        <label>Observaciones</label>
        <input class="form-control" type="text" placeholder="Observaciones" formControlName="observaciones" [(ngModel)]="facturaTmp.observaciones">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['observaciones'].errors?.maxlength">Estudios Realizados debe tener menos de 1000 caracteres</span>
        <br *ngIf="FacturacionCrearForm.controls['observaciones'].errors?.maxlength">
        <span style="color:Red;" *ngIf="FacturacionCrearForm.controls['observaciones'].errors?.pattern">No válido</span>
        <br *ngIf="FacturacionCrearForm.controls['observaciones'].errors?.pattern">
        <br>
      </form>
    </div> 
    <div class="botones">
      <div *ngIf="facturaEstatus==1" class="alert alert-primary" role="alert">Espere...</div>
      <div *ngIf="facturaEstatus==2" class="alert alert-success" role="alert">Factura registrada exitosamente</div>
      <div  *ngIf="facturaEstatus==3" class="alert alert-danger" role="alert">Error: {{msgError}}</div>
      <br>
      <button type="button" class="btn boton" style="background-color:red" data-dismiss="modal" (click)="c('')">Cerrar</button>
      <a>&nbsp;&nbsp;&nbsp;&nbsp;</a>
      <button *ngIf="facturaFlag== false" type="button" class="btn boton" disabled>Guardar</button> 
      <button *ngIf="facturaFlag == true" type="button" class="btn boton" (click)="crearFactura()" [disabled]="FacturacionCrearForm.invalid">Guardar</button>
    </div>
  </div>
</ng-template>





<ng-template #citaRemModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">{{citaTmp.prueba}}</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div class="row">
      <div *ngIf="citaTmp.tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p><strong>Fecha: </strong>{{citaTmp.fecha_cita}}</p>
        <p><strong>Precio de Venta: </strong>{{citaTmp.precioVenta}} MXN</p>
        <p><strong>Fecha de la Cita: </strong>{{citaTmp.fecha_cita}}</p>
        <p *ngIf="citaTmp.Sucursal==1"><strong>Sucursal: </strong>Cholula</p>
        <p *ngIf="citaTmp.Sucursal==2"><strong>Sucursal: </strong>13 Sur (Matriz)</p>
        <p *ngIf="citaTmp.Sucursal==3"><strong>Sucursal: </strong>5 de Mayo</p>
        <p *ngIf="citaTmp.Sucursal==4"><strong>Sucursal: </strong>Xonaca</p>
        <p *ngIf="citaTmp.Sucursal==6"><strong>Sucursal: </strong>Chapultepec</p>
        <p *ngIf="citaTmp.Sucursal==7"><strong>Sucursal: </strong>Cruz del Sur</p>
        <p *ngIf="citaTmp.Sucursal==8"><strong>Sucursal: </strong>San Alejandro</p>
        <p *ngIf="citaTmp.Sucursal==9"><strong>Sucursal: </strong>La Margarita</p>
        <p *ngIf="citaTmp.Sucursal==10"><strong>Sucursal: </strong>24 Sur</p>
        <p *ngIf="citaTmp.Sucursal==11"><strong>Sucursal: </strong>16 de Septiembre</p>
        <p *ngIf="citaTmp.Sucursal==12"><strong>Sucursal: </strong>Clínica Integral</p>
        <p *ngIf="citaTmp.Sucursal==13"><strong>Sucursal: </strong>Amozoc</p>
      </div>
      <div *ngIf="citaTmp.tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p *ngIf="citaTmp.hora_inicio"><strong>Hora Inicio: </strong>{{citaTmp.hora_inicio}}</p>
        <p *ngIf="!citaTmp.hora_inicio"><strong>Hora Inicio: </strong>No definido</p>
        <p *ngIf="citaTmp.hora_final"><strong>Hora Final: </strong>{{citaTmp.hora_final}}</p>
        <p *ngIf="!citaTmp.hora_final"><strong>Hora Final: </strong>No definido</p>
        <p *ngIf="citaTmp.estatus=='ACTIVA'"><strong>Estatus de Cita: </strong><strong style="color:#9AB638;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CERRADA'"><strong>Estatus de Cita: </strong><strong style="color:#B2EBFE;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CARRITO'"><strong>Estatus de Cita: </strong><strong style="color:#E5BE01;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CANCELADA'"><strong>Estatus de Cita: </strong><strong style="color:#FF0000;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus_rembolso=='SOLICITADO'"><strong>Estatus de Rembolso: </strong><strong style="color:#9AB638;">{{citaTmp.estatus_rembolso}}</strong></p>
        <p *ngIf="citaTmp.estatus_rembolso=='APROBADO'"><strong>Estatus de Rembolso: </strong><strong style="color:#B2EBFE;">{{citaTmp.estatus_rembolso}}</strong></p>
        <p *ngIf="citaTmp.estatus_rembolso=='RECHAZADO'"><strong>Estatus de Rembolso: </strong><strong style="color:#FF0000;">{{citaTmp.estatus_rembolso}}</strong></p>
        <p *ngIf="citaTmp.razon_rembolso"><strong>Razón de Rembolso: </strong>{{citaTmp.razon_rembolso}}</p>
        <p *ngIf="!citaTmp.razon_rembolso"><strong>Razón de Rembolso: </strong>No definida</p>
      </div>
      <div *ngIf="citaTmp.tipo_cita=='RESTRINGIDA'" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <h4  style="color:#9AB638; font-size: 25px;" class="modal-title">Tiempo Restringido</h4>
        <br>
        <p *ngIf="citaTmp.id"><strong>Id: </strong>{{citaTmp.id}}</p>
        <p *ngIf="citaTmp.hora_inicio"><strong>Hora Inicio: </strong>{{citaTmp.hora_inicio}}</p>
        <p *ngIf="!citaTmp.hora_inicio"><strong>Hora Inicio: </strong>No definido</p>
        <p *ngIf="citaTmp.hora_final"><strong>Hora Final: </strong>{{citaTmp.hora_final}}</p>
        <p *ngIf="!citaTmp.hora_final"><strong>Hora Final: </strong>No definido</p>
        <p *ngIf="citaTmp.estatus=='ACTIVA'"><strong>Estatus: </strong><strong style="color:#9AB638;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CERRADA'"><strong>Estatus: </strong><strong style="color:#B2EBFE;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CARRITO'"><strong>Estatus: </strong><strong style="color:#E5BE01;">{{citaTmp.estatus}}</strong></p>
        <p *ngIf="citaTmp.estatus=='CANCELADA'"><strong>Estatus: </strong><strong style="color:#FF0000;">{{citaTmp.estatus}}</strong></p>
      </div>
      <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <hr>
      </div>
      <div *ngIf="citaTmp.tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p style="color:#9AB638; font-size: 20px;"><strong>Estatus de Pago: </strong></p>
        <p *ngIf="citaTmp.id_pago"><strong>Identificador de Pago: </strong>{{citaTmp.id_pago}}</p>
        <p *ngIf="!citaTmp.id_pago"><strong>Identificador de Pago: </strong>No definido</p>
        <div *ngIf="citaTmp.tipo_pago =='OPENPAY'" class="alert alert-success" role="alert">Esta cita fue pagada en Open Pay</div>
        <div *ngIf="citaTmp.tipo_pago == 'PAYPAL'" class="alert alert-success" role="alert">Esta cita fue pagada en Pay Pal</div>
        <div *ngIf="citaTmp.tipo_pago == 'STRIPE'" class="alert alert-success" role="alert">Esta cita fue pagada con tarjeta</div>
        <div *ngIf="!citaTmp.id_pago" class="alert alert-warning" role="alert">Esta cita será pagada en Sucursal</div>
      </div>
      <div *ngIf="citaTmp.tipo_cita!='RESTRINGIDA'" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p style="color:#9AB638; font-size: 20px;"><strong>Registro: </strong></p>
        <p *ngIf="citaTmp.creador"><strong>Creador: </strong>{{citaTmp.creador}}</p>
        <p *ngIf="!citaTmp.creador"><strong>Creador: </strong>No definido</p>
        <p *ngIf="citaTmp.editor"><strong>Última Edición: </strong>{{citaTmp.editor}}</p>
        <p *ngIf="!citaTmp.editor"><strong>Última Edición: </strong>No definido</p>
        <p *ngIf="citaTmp.creacion"><strong>Fecha Creación: </strong>{{citaTmp.creacion.split('T')[0]}} {{citaTmp.creacion.substring(11,19)}}</p>
        <p *ngIf="citaTmp.ultimaActualizacion"><strong>Fecha Última Edición: </strong>{{citaTmp.ultimaActualizacion.split('T')[0]}} {{citaTmp.ultimaActualizacion.substring(11,19)}}</p>
      </div>
      <div *ngIf="citaTmp.tipo_cita=='RESTRINGIDA'" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <p style="color:#9AB638; font-size: 20px;"><strong>Registro: </strong></p>
        <p *ngIf="citaTmp.creador"><strong>Creador: </strong>{{citaTmp.creador}}</p>
        <p *ngIf="!citaTmp.creador"><strong>Creador: </strong>No definido</p>
        <p *ngIf="citaTmp.editor"><strong>Última Edición: </strong>{{citaTmp.editor}}</p>
        <p *ngIf="!citaTmp.editor"><strong>Última Edición: </strong>No definido</p>
        <p *ngIf="citaTmp.creacion"><strong>Fecha Creación: </strong>{{citaTmp.creacion.split('T')[0]}} {{citaTmp.creacion.substring(11,19)}}</p>
        <p *ngIf="citaTmp.ultimaActualizacion"><strong>Fecha Última Edición: </strong>{{citaTmp.ultimaActualizacion.split('T')[0]}} {{citaTmp.ultimaActualizacion.substring(11,19)}}</p>
      </div>
      <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <hr>
      </div>
      <div *ngIf="citaTmp.notas" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <p style="color:#9AB638; font-size: 20px;"><strong>Notas: </strong></p>
        <p>{{citaTmp.notas}}</p>
        <hr>
      </div>   
      <div *ngIf="citaTmp.otro_nombre_paciente" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <p style="color:#9AB638; font-size: 20px;"><strong>El estudio es para otro paciente: </strong></p>
        <p ><strong>Nombre del paciente: </strong>{{citaTmp.otro_nombre_paciente}}</p>
        <p ><strong>Fecha de nacimiento: </strong>{{citaTmp.otro_fecha_nacimento}}</p>
        <p ><strong>Parentesco: </strong>{{citaTmp.otro_parentesco_paciente}}</p>
      <hr>
      </div>         
      <div *ngIf="citaTmp.Paciente" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <p style="color:#9AB638; font-size: 20px;"><strong>Paciente: </strong></p>
        <p *ngIf="citaTmp.Paciente"><strong>Nombre: </strong>{{citaTmp.Paciente.nombre}} {{citaTmp.Paciente.apellido_paterno}} {{citaTmp.Paciente.apellido_materno}} </p>
        <p *ngIf="citaTmp.Paciente.sexo"><strong>Sexo: </strong>{{citaTmp.Paciente.sexo}}</p>
        <p *ngIf="!citaTmp.Paciente.sexo"><strong>Sexo: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.discapacidad"><strong>Discapacidad: </strong>{{citaTmp.Paciente.discapacidad}}</p>
        <p *ngIf="!citaTmp.Paciente.discapacidad"><strong>Discapacidad: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.tipo_sangre"><strong>Tipo de sangre: </strong>{{citaTmp.Paciente.tipo_sangre}}</p>
        <p *ngIf="!citaTmp.Paciente.tipo_sangre"><strong>Tipo de sangre: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.fecha_nacimiento"><strong>Fecha de Nacimiento: </strong>{{citaTmp.Paciente.fecha_nacimiento}} </p>
        <p *ngIf="!citaTmp.Paciente.fecha_nacimiento"><strong>Fecha de Nacimiento: </strong>No definido </p>
      </div>  
      <div *ngIf="citaTmp.Paciente" class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <br><br>
        <p *ngIf="citaTmp.Paciente.fecha_nacimiento && edadMeses > 11"><strong>Edad: </strong>{{edad}} años</p>
        <p *ngIf="citaTmp.Paciente.fecha_nacimiento && edadMeses < 11"><strong>Edad: </strong>{{edadMeses}} meses</p>
        <p *ngIf="!citaTmp.Paciente.fecha_nacimiento"><strong>Edad: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.email"><strong>Correo: </strong>{{citaTmp.Paciente.email}}</p>
        <p *ngIf="!citaTmp.Paciente.email"><strong>Correo: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.telefonoOficina"><strong>Tel. Oficina: </strong>{{citaTmp.Paciente.telefonoOficina}}</p>
        <p *ngIf="!citaTmp.Paciente.telefonoOficina"><strong>Tel. Oficina: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.telefonoCasa"><strong>Tel. Casa: </strong>{{citaTmp.Paciente.telefonoCasa}}</p>
        <p *ngIf="!citaTmp.Paciente.telefonoCasa"><strong>Tel. Casa: </strong>No definido</p>
        <p *ngIf="citaTmp.Paciente.telefonoCelular"><strong>Tel. Celular: </strong>{{citaTmp.Paciente.telefonoCelular}}</p>
        <p *ngIf="!citaTmp.Paciente.telefonoCelular"><strong>Tel. Celular: </strong>No definido</p>
      </div>
    </div>
    <div class="botones">
      <button type="button" class="btn btn-success" data-dismiss="modal" (click)="c('')">Cerrar</button>
      <a>&nbsp;&nbsp;&nbsp;&nbsp;</a>
      <button *ngIf="!this.empleado.auditor" type="button" style="color:white;" class="btn btn-warning" (click)="rellenarCamposEditarRem()" (click)="verEstudios(editarRemModal)">Finalizar Rembolso</button>
      <button *ngIf="this.empleado.auditor" type="button" style="color:white;" class="btn btn-warning" disabled>Finalizar Rembolso</button>
    </div>
  </div>
</ng-template>

<ng-template #nuevaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 *ngIf="sucursalSeleccionada && salaSeleccionada" style="text-align: center;">Crear Cita - Sucursal: {{listaSucursales[sucursalSeleccionada]}} Sala: {{salaSeleccionada}}</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div  class="modal-body">
    <form [formGroup]="citaCrearFormulario">
      <label>Tiempo Restringido</label>
      <br>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <input type="checkbox" class="form-check-input" formControlName="citaRestringida" [(ngModel)]="citaRestringida" >
      <label class="form-check-label">Activar</label> 
      <div *ngIf="citaRestringida">
        <br><br> 
        <h6  class="titulo" style="font-size: 25px; text-align: center;">Al seleccionar Tiempo Restringido no será posible agendar citas durante ese periodo de tiempo</h6>
      </div>
      <br><br>
        <div *ngIf="!citaRestringida">
          <label>Prueba (Requerido)</label>
          <input class="form-control" type="text" placeholder="Prueba" formControlName="prueba"  [(ngModel)]="citaTmp.prueba">
          <span style="color:Red;" *ngIf="citaCrearFormulario.controls['prueba'].errors?.minlength">Debe ser de mas de 5 caracteres</span>
          <span style="color:Red;" *ngIf="citaCrearFormulario.controls['prueba'].errors?.maxlength">No debe ser de mas de 500 caracteres</span>
          <span style="color:Red;" *ngIf="citaCrearFormulario.controls['prueba'].touched && citaCrearFormulario.controls['prueba'].errors?.required">Campo Requerido.</span>
          <br>
          <br>
          <span style="color:Red;" *ngIf="citaCrearFormulario.controls['prueba'].errors?.pattern">No válido</span>
          <label>Categoría (Requerido)</label>
          <select  [(ngModel)]="citaTmp.categoria" placeholder="Seleccionar Categoría..." class="custom-select mr-sm-2" id="inlineFormCustomSelect" formControlName="categoria" autocomplete="off">
            <option value="Analisis Sanguineos" >Analisis Sanguíneos</option>
            <option value="Analisis Clinicos" >Analisis Clínicos</option>
            <option value="Ultrasonografia" >Ultrasonografía</option>
            <option value="Ultrasonografia Doppler" >Ultrasonografía Doppler</option>
            <option value="Rayos X" >Rayos X</option>
            <option value="Rayos X Contrastados" >Rayos X Contrastados</option>
            <option value="Mastografia" >Mastografía</option>
            <option value="Papanicolau" >Papanicolau</option>
            <option value="Tomografia" >Tomografía</option>
            <option value="Tomografia Contrastada" >Tomografía Contrastada</option>
            <option value="Resonancia Magnetica" >Resonancia Magnética</option>
            <option value="Resonancia Magnetica Contrastada" >Resonancia Magnética Contrastada</option>
            <option value="Colposcopia" >Colposcopía</option>
            <option value="Densitometria" >Densitometría</option>
            <option value="Audiologia" >Audiología</option>
            <option value="Espirometria" >Espirometría</option>
            <option value="Cardiologia" >Cardiología</option>
            <option value="Patologia" >Patología</option>
            <option value="Consulta" >Consulta</option>
            <option value="Ginecologia" >Ginecología</option>
            <option value="Rehabilitacion" >Rehabilitacion</option>
          </select> 
          <span style="color:Red;" *ngIf="citaCrearFormulario.controls['categoria'].touched && citaCrearFormulario.controls['categoria'].errors?.required">Campo Requerido.</span>
          <br><br><br>
          <label (change)="purgarTiempo()">Precio de Venta (Requerido)</label> 
          <input class="form-control" placeholder="Precio de Venta" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" formControlName="precioVenta" [(ngModel)]="citaTmp.precioVenta" >
          <span style="color:Red;" *ngIf="citaCrearFormulario.controls['precioVenta'].errors?.min">Valor mínimo superado</span>
          <span style="color:Red;" *ngIf="citaCrearFormulario.controls['precioVenta'].errors?.max">Valor máximo superado</span>
          <span style="color:Red;" *ngIf="citaCrearFormulario.controls['precioVenta'].touched && citaCrearFormulario.controls['precioVenta'].errors?.required">Campo Requerido.</span>
          <br>
          <button type="button" class="btn boton" (click)="verEstudios(pruebaModal)">Seleccionar Prueba</button>
        </div>
        <hr>
        <label>Fecha (Requerida)</label>
        <input class="form-control" id="date" type="date" formControlName="fecha_cita" [(ngModel)]="citaTmp.fecha_cita" >
        <span style="color:Red;" *ngIf="citaCrearFormulario.controls['fecha_cita'].errors?.minDate">Esta fecha no es válida</span>
        <span style="color:Red;" *ngIf="citaCrearFormulario.controls['fecha_cita'].errors?.maxDate">Esta fecha no puede superar 6 meses a partir del día de hoy</span>
        <span style="color:Red;" *ngIf="citaCrearFormulario.controls['fecha_cita'].touched && citaCrearFormulario.controls['fecha_cita'].errors?.required">Campo Requerido.</span>
        <br>
        <label>Hora Inicio (Requerida)</label>
        <br>
        <input type="time" name="hora_inicio"  formControlName="hora_inicio"  [(ngModel)]="citaTmp.hora_inicio">
        <br>
        <span style="color:Red;" *ngIf="citaCrearFormulario.controls['hora_inicio'].touched && citaCrearFormulario.controls['hora_inicio'].errors?.required">Campo Requerido.</span>
        <br>
        <label>Hora Final (Requerida)</label>
        <br>
        <input type="time" name="hora_final"  formControlName="hora_final"  [(ngModel)]="citaTmp.hora_final">
        <span style="color:Red;" *ngIf="citaCrearFormulario.controls['hora_final'].touched && citaCrearFormulario.controls['hora_final'].errors?.required">Campo Requerido.</span>
        <span style="color:Red;" *ngIf="citaCrearFormulario.errors" > Por favor revise el horario ingresado</span>
        <br><br>
        <h6 *ngIf="citaTmp.categoria && tiempo > 0" class="titulo" style="font-size: 25px; text-align: center;">Tiempo recomendado: {{tiempo}} Minutos</h6>
        <br *ngIf="!citaRestringida">
        <button *ngIf="citaTmp.categoria && !citaRestringida"  (click)="consultarTiempo()" type="button" class="btn boton" >Tiempo de estudio</button> 
        <button *ngIf="!citaTmp.categoria && !citaRestringida" type="button" class="btn boton" disabled>Tiempo de estudio</button> 
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button *ngIf="tiempo>0 && citaTmp.hora_inicio && citaTmp.fecha_cita" type="button" (click)="asignarTiempo()" class="btn boton" >Asignar tiempo</button> 
        <br *ngIf="!citaRestringida">
        <hr>
        <label>Notas</label>
        <input class="form-control" type="text" placeholder="Notas" formControlName="notas"  [(ngModel)]="citaTmp.notas">
        <span style="color:Red;" *ngIf="citaCrearFormulario.controls['notas'].errors?.minlength">Las notas no deben ser menores a 5 caracteres</span>
        <span style="color:Red;" *ngIf="citaCrearFormulario.controls['notas'].errors?.maxlength">Las notas no deben ser mayores a 500 caracteres</span>
        <br>
        <div *ngIf="!citaRestringida">
          <hr>
          <label>Paciente </label>
          <input class="form-control" type="text" placeholder="Paciente" formControlName="paciente"  [(ngModel)]="nombrePaciente" readonly>
          <br>
          <button type="button" class="btn boton" (click)="consultarPacientesOp()" (click)="verEstudios(pacienteModal)">Seleccionar Paciente</button>
          <br>
        </div>
        <hr>
      </form>
      <br>
      <div *ngIf="citaEstatus==1" class="alert alert-primary" role="alert">Espere...</div>
      <div *ngIf="citaEstatus==2" class="alert alert-success" role="alert">Cita Agendada Exitosamente</div>
      <div  *ngIf="citaEstatus==3" class="alert alert-danger" role="alert">Error: {{msgError}}</div>
      <div *ngIf="!citaRestringida">
        <button type="button" class="btn boton" (click)="c('')">Regresar</button> 
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button *ngIf="citaTmp.fecha_cita && citaTmp.hora_inicio && citaTmp.hora_final && citaTmp.prueba && citaTmp.categoria && citaTmp.precioVenta" type="button" class="btn boton" (click)="agendarCita()" >Agendar</button> 
        <button *ngIf="!citaTmp.fecha_cita || !citaTmp.hora_inicio || !citaTmp.hora_final || !citaTmp.prueba || !citaTmp.categoria || !citaTmp.precioVenta" type="button" class="btn boton" disabled>Agendar</button> 
      </div>
      <div *ngIf="citaRestringida">
        <button type="button" class="btn boton" (click)="c('')">Regresar</button>  
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button *ngIf="citaTmp.fecha_cita && citaTmp.hora_inicio && citaTmp.hora_final && citaTmp.hora_inicio<citaTmp.hora_final" type="button" class="btn boton" (click)="agendarCitaRestringida()">Agendar</button> 
        <button *ngIf="!citaTmp.fecha_cita || !citaTmp.hora_inicio || !citaTmp.hora_final || citaTmp.hora_inicio>=citaTmp.hora_final" type="button" class="btn boton" disabled>Agendar</button> 
      </div>
  </div>
</ng-template>

<ng-template #buscarModal let-c="close" led-d="dismiss"> 
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Historial de Citas</h4>  
      <button type="button" class="close" style="color:white;"  (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <table id="lista" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>Num.</th>
            <th>Prueba</th>
            <th>Categoria</th>
            <th>Paciente</th>
            <th>Estatus</th>
            <th>Registro</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let results of citasList.results; index as i" (click)="verEstudiosBuscar(results, citaModal)">
            <td><span >{{results.id}}</span></td>
            <td><span >{{results.prueba.substr(0,40)}}</span></td>
            <td><span >{{results.categoria}}</span></td>
            <td *ngIf="results.Paciente"><span >{{results.Paciente.nombre}} {{results.Paciente.apellido_paterno}} {{results.Paciente.apellido_materno}}</span></td>
            <td *ngIf="!results.Paciente"><span ></span></td>
            <td><span >{{results.estatus}}</span></td>
            <td><span >{{results.creacion.substring(0,10)}} {{results.creacion.substring(11,16)}}</span></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
  </div>
</ng-template>

<ng-template #abiertasModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Citas Abiertas</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <table id="lista" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
      <thead>
        <tr>
            <th>Num.</th>
            <th>Prueba</th>
            <th>Paciente</th>
            <th>Estatus</th>
            <th>Registro</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let results of citasAbi.results; index as i " (click)="verEstudiosAbiertos(results, citaModal)"> 
          <td><span >{{results.id}}</span></td>
          <td><span >{{results.prueba.substr(0,30)}}</span></td>
          <td *ngIf="results.Paciente"><span >{{results.Paciente.nombre}} {{results.Paciente.apellido_paterno}} {{results.Paciente.apellido_materno}}</span></td>
          <td *ngIf="!results.Paciente"><span ></span></td>
          <td><span >{{results.estatus}}</span></td>
          <td><span >{{results.creacion.substring(0,10)}} {{results.creacion.substring(11,16)}}</span></td>
        </tr>
      </tbody>
    </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
  </div>
</ng-template>

<ng-template #rembolsosModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Rembolsos</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <table id="lista" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>Num.</th>
            <th>Prueba</th>
            <th>Paciente</th>
            <th>Estatus Cita</th>
            <th>Estatus Rem</th>
            <th>Registro</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let results of citasRem.results; index as i" (click)="verEstudiosRembolso(results, citaRemModal)">
            <td><span >{{results.id}}</span></td>
            <td><span >{{results.prueba.substr(0,20)}}</span></td>
            <td *ngIf="results.Paciente"><span >{{results.Paciente.nombre}} {{results.Paciente.apellido_paterno}} {{results.Paciente.apellido_materno}}</span></td>
            <td *ngIf="!results.Paciente"><span ></span></td>
            <td><span >{{results.estatus}}</span></td>
            <td><span >{{results.estatus_rembolso}}</span></td>
            <td><span >{{results.creacion.substring(0,10)}} {{results.creacion.substring(11,16)}}</span></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
  </div>
</ng-template>


<ng-template #empresaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Empresas</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <table id="listaEmp" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>Num.</th>
            <th>Estudio.</th>
            <th>Categoria.</th>
            <th>Paciente.</th> 
            <th>Empresa.</th>
            <th>Creación.</th>
          </tr>
        </thead>
        <tbody> 
          <tr *ngFor="let results of estudioEmpresas.results; index as i" (click)="verEstudioEmpresa(results, EstudioEmpresaModal)" >
            <td><span >{{results.id}}</span></td>
            <td><span >{{results.nombreEstudio}}</span></td>
            <td><span >{{results.categoria}}</span></td> 
            <td *ngIf="results.Paciente"><span >{{results.Paciente.nombre}} {{results.Paciente.apellido_paterno}} {{results.Paciente.apellido_materno}}</span></td>
            <td *ngIf="!results.Paciente"><span >No definido</span></td>
            <td *ngIf="results.Empresa"><span >{{results.Empresa.nombreEmpresa}}</span></td>
            <td *ngIf="!results.Empresa"><span >No definido</span></td>
            <td><span >{{results.creacion.substring(0,10)}} {{results.creacion.substring(11,16)}}</span></td>
          </tr>
        </tbody> 
      </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" class="btn boton" (click)="purgarEstudioEmpresa()" (click)="verNuevoEstudioEmpresaModal(nuevoEstudioEmpresaModal)">Nuevo</button>    
  </div>
</ng-template>

<ng-template #callModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Call Center</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <div style="text-align: center;" class="alert alert-success" role="alert">Por favor seleccione un menú</div>
      <br>
      <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" style="text-align: center;">
        <button type="button" class="btn boton" (click)="c('')" (click)="verEstudios(comentariosModal)" (click)="consultarComentarios()" >Comentarios</button>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button type="button" class="btn boton" (click)="c('')" (click)="verEstudios(quejasSugerenciasModal)" (click)="consultarQuejasSugerenciasOp()">Quejas y Sugerencias</button>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button type="button" class="btn boton" (click)="c('')" (click)="consultarCall()"  (click)="verEstudios(llamadasModal)" >Llamadas</button>
        <br><br>
      </div> 
  </div>
</ng-template>


<ng-template #comentariosModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Comentarios</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <table id="listaCom" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>Num.</th>
            <th>Fecha.</th>
            <th>Hora.</th>
            <th>Paciente.</th>
            <th>Tipo.</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let results of comentarios.results; index as i" (click)="verComentario(results, comentarioModal)" >
            <td><span >{{results.id}}</span></td>
            <td><span >{{results.fecha}}</span></td>
            <td><span >{{results.hora}}</span></td>
            <td><span >{{results.nombre_paciente}}</span></td>
            <td><span >{{results.tipo_opinion}}</span></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" class="btn boton" (click)="verNuevoComentario(nuevoComentarioModal)">Nuevo</button>
  </div>
</ng-template>

<ng-template #comentarioModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Comentario</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div *ngIf="comentario"> 
      <div class="row">       
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" >
          <p>Id. llamada: <strong>{{comentario.id}}</strong></p>
          <p>Num. recibo: <strong>{{comentario.num_recibo}}</strong></p>
          <p *ngIf="!comentario.num_recibo">Num. recibo: <strong >No definido</strong></p>
          <p>Nombre paciente: <strong>{{comentario.nombre_paciente}}</strong></p>
          <p *ngIf="!comentario.nombre_paciente">Nombre paciente: <strong >No definido</strong></p>
          <p>Teléfono: <strong>{{comentario.telefono}}</strong></p>
          <p *ngIf="!comentario.telefono">Teléfono: <strong >No definido</strong></p>
          <p>Email: <strong>{{comentario.email}}</strong></p>
          <p *ngIf="!comentario.email">email: <strong >No definido</strong></p>
          <p>Fecha: <strong>{{comentario.fecha}}</strong></p>
          <p *ngIf="!comentario.fecha">Fecha: <strong >No definido</strong></p>
          <p>Hora: <strong>{{comentario.hora}}</strong></p>
          <p *ngIf="!comentario.hora">Hora: <strong >No definido</strong></p>
          <hr>
          <p>Nombre del personal: <strong>{{comentario.nombre_personal}}</strong></p>
          <p *ngIf="!comentario.nombre_personal">Nombre del personal: <strong >No definido</strong></p>
          <p>Sucursal: <strong>{{comentario.sucursal}}</strong></p>
          <p *ngIf="!comentario.sucursal">Sucursal: <strong >No definido</strong></p>
          <p>¿Cómo se entero?: <strong>{{comentario.como_entero}}</strong></p>
          <p *ngIf="!comentario.como_entero">¿Cómo se entero?: <strong >No definido</strong></p>
          <p>Estudios solicitados: <strong>{{comentario.estudios_solicitados}}</strong></p>
          <p *ngIf="!comentario.estudios_solicitados">Estudios solicitados: <strong >No definido</strong></p>
          <p>Tipo de opinión: <strong>{{comentario.tipo_opinion}}</strong></p>
          <p *ngIf="!comentario.tipo_opinion">Tipo de opinión: <strong >No definido</strong></p>
          <hr>
          <p>Comentarios: <strong>{{comentario.comentarios}}</strong></p>
          <p *ngIf="!comentario.comentarios">Comentarios: <strong >No definido</strong></p>
          <hr *ngIf="comentario.notas"> 
          <p *ngIf="comentario.notas">Notas: <strong>{{comentario.notas}}</strong></p>
          <hr>
          <p *ngIf="comentario.creador">Creador: <strong>{{comentario.creador}}</strong></p>
          <p *ngIf="!comentario.creador">Creador: <strong>No definido</strong></p>
          <p *ngIf="comentario.editor">Editor: <strong>{{comentario.editor}}</strong></p>
          <p *ngIf="!comentario.editor">Editor: <strong>No definido</strong></p>
          <p *ngIf="comentario.creacion">Creación: <strong>{{comentario.creacion.substring(0,10)}} {{comentario.creacion.substring(11,16)}}</strong></p>
          <p *ngIf="!comentario.creacion">Creación: <strong>No definido</strong></p>
          <p *ngIf="comentario.ultimaActualizacion">Última Actualización: <strong>{{comentario.ultimaActualizacion.substring(0,10)}} {{comentario.ultimaActualizacion.substring(11,16)}}</strong></p>
          <p *ngIf="!comentario.ultimaActualizacion">Última Actualización: <strong>No definido</strong></p>                     
        </div>
      </div>
    </div>
    <button type="button" class="btn boton" (click)="c('')">Regresar</button>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <button type="button" class="btn boton" (click)="purgarComentario()" (click)="verEstudios(editarComentario)">Notas</button>
  </div>
</ng-template>


<ng-template #nuevoComentarioModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Nuevo comentario</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <form [formGroup]="comentarioForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> 
      <label class="editar" >Sucursal (Opcional)</label>
      <select class="form-control" id="sucursal" formControlName="sucursal" [(ngModel)]="comentarioTmp.sucursal" autocomplete="off">
        <option selected>Cholula</option>
        <option>13 Sur (Matriz)</option>
        <option>5 de Mayo</option>
        <option>Xonaca</option>
        <option>Chapultepec</option>
        <option>Cruz del Sur</option>
        <option>San Alejandro</option>
        <option>La Margarita</option>
        <option>24 Sur</option>
        <option>16 de Septiembre</option>
        <option>Clínica Integral</option>
        <option>Amozoc</option>
        <option>Cholula</option>
        <option>105 Pte</option>
      </select>
      <br>
      <label>Fecha (Requerida)</label>
      <input class="form-control" id="date" type="date" formControlName="fecha" [(ngModel)]="comentarioTmp.fecha" >
      <span style="color:Red;" *ngIf="comentarioForm.controls['fecha'].errors?.minDate">Esta fecha no es válida</span>
      <br *ngIf="comentarioForm.controls['fecha'].errors?.minDate">
      <span style="color:Red;" *ngIf="comentarioForm.controls['fecha'].errors?.maxDate">Esta fecha no es válida</span>
      <br *ngIf="comentarioForm.controls['fecha'].errors?.maxDate">
      <span style="color:Red;" *ngIf="comentarioForm.controls['fecha'].touched && comentarioForm.controls['fecha'].errors?.required">Requerido.</span>
      <br *ngIf="comentarioForm.controls['fecha'].touched && comentarioForm.controls['fecha'].errors?.required">     
      <br>
      <label>Hora de evento (Requerida)</label>
      <br>
      <input type="time" name="hora"  formControlName="hora"  [(ngModel)]="comentarioTmp.hora">
      <br>
      <span style="color:Red;" *ngIf="comentarioForm.controls['hora'].touched && comentarioForm.controls['hora'].errors?.required">Requerido.</span>
      <br *ngIf="comentarioForm.controls['hora'].touched && comentarioForm.controls['hora'].errors?.required">
      <br>
      <label>Número de recibo (Opcional)</label>
      <input class="form-control" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" placeholder="" formControlName="num_recibo" [(ngModel)]="comentarioTmp.num_recibo">
      <span style="color:Red;" *ngIf="comentarioForm.controls['num_recibo'].errors?.min">No válido</span>
      <br *ngIf="comentarioForm.controls['num_recibo'].errors?.min">
      <span style="color:Red;" *ngIf="comentarioForm.controls['num_recibo'].errors?.max">No válido</span>
      <br *ngIf="comentarioForm.controls['num_recibo'].errors?.max">
      <span style="color:Red;" *ngIf="comentarioForm.controls['num_recibo'].touched && comentarioForm.controls['num_recibo'].errors?.required">Requerido.</span>
      <br *ngIf="comentarioForm.controls['num_recibo'].touched && comentarioForm.controls['num_recibo'].errors?.required">     
      <br>  
      <label>Nombre del paciente (Requerido)</label>
      <input class="form-control" type="text" placeholder="nombre paciente" formControlName="nombre_paciente" [(ngModel)]="comentarioTmp.nombre_paciente">
      <span style="color:Red;" *ngIf="comentarioForm.controls['nombre_paciente'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="comentarioForm.controls['nombre_paciente'].errors?.minlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['nombre_paciente'].errors?.maxlength">Debe tener menos de 100 caracteres.</span>
      <br *ngIf="comentarioForm.controls['nombre_paciente'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['nombre_paciente'].errors?.pattern"> No válido.</span>
      <br *ngIf="comentarioForm.controls['nombre_paciente'].errors?.pattern">     
      <span style="color:Red;" *ngIf="comentarioForm.controls['nombre_paciente'].touched && comentarioForm.controls['nombre_paciente'].errors?.required">Requerido.</span>
      <br *ngIf="comentarioForm.controls['nombre_paciente'].touched && comentarioForm.controls['nombre_paciente'].errors?.required">
      <br>  
      <label>Teléfono (Opcional)</label>
      <input class="form-control" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" placeholder="" formControlName="telefono" [(ngModel)]="comentarioTmp.telefono">
      <span style="color:Red;" *ngIf="comentarioForm.controls['telefono'].errors?.min">No válido</span>
      <br *ngIf="comentarioForm.controls['telefono'].errors?.min">
      <span style="color:Red;" *ngIf="comentarioForm.controls['telefono'].errors?.max">No válido</span>
      <br *ngIf="comentarioForm.controls['telefono'].errors?.max">
      <span style="color:Red;" *ngIf="comentarioForm.controls['telefono'].touched && comentarioForm.controls['telefono'].errors?.required">Requerido.</span>
      <br *ngIf="comentarioForm.controls['telefono'].touched && comentarioForm.controls['telefono'].errors?.required">     
      <br>  
      <label>Correo (Opcional)</label>
      <input autocomplete="off" type="email" id="email" name="email" class="form-control" placeholder="Correo" [(ngModel)]="comentarioTmp.email" formControlName="email" (change)="consultarDisponibilidadEmail()">
      <div *ngIf="(pacienteFlag==1 || medicoFlag==1)" style="text-align: center;" class="alert alert-success" role="alert">Este correo ya se encuentra registrado. </div> 
      <div *ngIf="((pacienteFlag==2 || medicoFlag==2) && (this.comentarioForm.controls['email'].errors)==null)" style="text-align: center;" class="alert alert-warning" role="alert">Este correo no se encuentra registrado. </div> 
      <span style="color:Red;" *ngIf="comentarioForm.controls['email'].errors?.minlength">El correo debe tener mínimo 5 caracteres</span>
      <br *ngIf="comentarioForm.controls['email'].errors?.minlength">
      <span style="color:Red;" *ngIf="comentarioForm.controls['email'].errors?.maxlength">El correo no puede superar los 40 caracteres</span>
      <br *ngIf="comentarioForm.controls['email'].errors?.maxlength">
      <span style="color:Red;" *ngIf="comentarioForm.controls['email'].errors?.pattern">No parece ser un correo válido</span>   
      <br *ngIf="comentarioForm.controls['email'].errors?.pattern">
      <br>
      <label>Estudios solicitados (Opcional)</label>
      <input class="form-control" type="text" placeholder="estudios solicitados" formControlName="estudios_solicitados" [(ngModel)]="comentarioTmp.estudios_solicitados">
      <span style="color:Red;" *ngIf="comentarioForm.controls['estudios_solicitados'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="comentarioForm.controls['estudios_solicitados'].errors?.minlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['estudios_solicitados'].errors?.maxlength">Debe tener menos de 300 caracteres.</span>
      <br *ngIf="comentarioForm.controls['estudios_solicitados'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['estudios_solicitados'].errors?.pattern"> No válido.</span>
      <br *ngIf="comentarioForm.controls['estudios_solicitados'].errors?.pattern">  
      <br>  
      <label>¿Cómo se enteró? (Opcional)</label>
      <select class="form-control" id="como_entero" formControlName="como_entero" [(ngModel)]="comentarioTmp.como_entero" autocomplete="off">
        <option [ngValue]="'Anuncio en la calle'"selected>Anuncio en la calle</option> 
        <option [ngValue]="'Volantes/Folletos'">Volantes/Folletos</option>
        <option  [ngValue]="'Internet'">Internet</option>
        <option  [ngValue]="'Recomendacion'">Recomendación</option>
      </select> 
      <br>  
      <label>Tipo de opinión (Requerido)</label>
      <select class="form-control" id="tipo_opinion" formControlName="tipo_opinion" [(ngModel)]="comentarioTmp.tipo_opinion" autocomplete="off">
        <option [ngValue]="'Queja'"selected>Queja</option> 
        <option [ngValue]="'Felicitaciones'">Felicitaciones</option>
        <option  [ngValue]="'Comentarios'">Comentarios</option>
      </select> 
      <span style="color:Red;" *ngIf="comentarioForm.controls['tipo_opinion'].touched && comentarioForm.controls['tipo_opinion'].errors?.required">Requerido.</span>
      <br *ngIf="comentarioForm.controls['tipo_opinion'].touched && comentarioForm.controls['tipo_opinion'].errors?.required">     
      <br>  
      <label>Nombre del personal (Opcional)</label>
      <input class="form-control" type="text" placeholder="nombre personal" formControlName="nombre_personal" [(ngModel)]="comentarioTmp.nombre_personal">
      <span style="color:Red;" *ngIf="comentarioForm.controls['nombre_personal'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="comentarioForm.controls['nombre_personal'].errors?.minlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['nombre_personal'].errors?.maxlength">Debe tener menos de 100 caracteres.</span>
      <br *ngIf="comentarioForm.controls['nombre_personal'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['nombre_personal'].errors?.pattern"> No válido.</span>
      <br *ngIf="comentarioForm.controls['nombre_personal'].errors?.pattern">  
      <br>  
      <label>Comentarios (Requerido)</label>
      <input class="form-control" type="text" placeholder="comentarios" formControlName="comentarios" [(ngModel)]="comentarioTmp.comentarios">
      <span style="color:Red;" *ngIf="comentarioForm.controls['comentarios'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="comentarioForm.controls['comentarios'].errors?.minlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['comentarios'].errors?.maxlength">Debe tener menos de 300 caracteres.</span>
      <br *ngIf="comentarioForm.controls['comentarios'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['comentarios'].errors?.pattern"> No válido.</span>
      <br *ngIf="comentarioForm.controls['comentarios'].errors?.pattern">   
      <span style="color:Red;" *ngIf="comentarioForm.controls['comentarios'].touched && comentarioForm.controls['comentarios'].errors?.required">Requerido.</span>
      <br *ngIf="comentarioForm.controls['comentarios'].touched && comentarioForm.controls['comentarios'].errors?.required">     
      <br>  
      <label>Notas (Opcional)</label>
      <input class="form-control" type="text" placeholder="notas" formControlName="notas" [(ngModel)]="comentarioTmp.notas">
      <span style="color:Red;" *ngIf="comentarioForm.controls['notas'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="comentarioForm.controls['notas'].errors?.minlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['notas'].errors?.maxlength">Debe tener menos de 500 caracteres.</span>
      <br *ngIf="comentarioForm.controls['notas'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="comentarioForm.controls['notas'].errors?.pattern"> No válido.</span>
      <br *ngIf="comentarioForm.controls['notas'].errors?.pattern">  
      <br>  
    </form>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" class="btn boton"  (click)="c('')" (click)="crearComentarioOp()"  [disabled]="comentarioForm.invalid">Guardar</button> 
  </div>
</ng-template>


<ng-template #nuevoQuejaSujerencia let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Nueva queja & sugerencia</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <form [formGroup]="quejasSugerenciasForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> 
      <label>Folio (Opcional)</label>
      <input class="form-control" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" placeholder="" formControlName="folio" [(ngModel)]="quejasSugerenciasTmp.folio">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['folio'].errors?.min">No válido</span>
      <br *ngIf="quejasSugerenciasForm.controls['folio'].errors?.min">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['folio'].errors?.max">No válido</span>
      <br *ngIf="quejasSugerenciasForm.controls['folio'].errors?.max">
      <br> 
      <label>Tipo (Requerido)</label>
      <select class="form-control" id="tipo" formControlName="tipo" [(ngModel)]="quejasSugerenciasTmp.tipo" autocomplete="off">
        <option [ngValue]="'Queja Interna'"selected>Queja Interna</option> 
        <option [ngValue]="'Queja Externa'">Queja Externa</option>
        <option  [ngValue]="'Sugerencia'">Sugerencia</option>
      </select> 
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['tipo'].touched && quejasSugerenciasForm.controls['tipo'].errors?.required">Requerido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['tipo'].touched && quejasSugerenciasForm.controls['tipo'].errors?.required">     
      <br>  
      <label>Fecha de evento (Requerida)</label>
      <input class="form-control" id="date" type="date" formControlName="fecha_evento" [(ngModel)]="quejasSugerenciasTmp.fecha_evento" >
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['fecha_evento'].errors?.minDate">Esta fecha no es válida</span>
      <br *ngIf="quejasSugerenciasForm.controls['fecha_evento'].errors?.minDate">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['fecha_evento'].errors?.maxDate">Esta fecha no es válida</span>
      <br *ngIf="quejasSugerenciasForm.controls['fecha_evento'].errors?.maxDate">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['fecha_evento'].touched && quejasSugerenciasForm.controls['fecha_evento'].errors?.required">Requerido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['fecha_evento'].touched && quejasSugerenciasForm.controls['fecha_evento'].errors?.required">     
      <br>
      <label>Hora de evento (Requerida)</label>
      <br>
      <input type="time" name="hora_evento"  formControlName="hora_evento"  [(ngModel)]="quejasSugerenciasTmp.hora_evento">
      <br>
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['hora_evento'].touched && quejasSugerenciasForm.controls['hora_evento'].errors?.required">Requerido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['hora_evento'].touched && quejasSugerenciasForm.controls['hora_evento'].errors?.required">
      <br>
      <label class="editar" >Sucursal (Opcional)</label>
      <select class="form-control" id="sucursal" formControlName="sucursal" [(ngModel)]="quejasSugerenciasTmp.sucursal" autocomplete="off">
        <option selected>Cholula</option>
        <option>13 Sur (Matriz)</option>
        <option>5 de Mayo</option>
        <option>Xonaca</option>
        <option>Chapultepec</option>
        <option>Cruz del Sur</option>
        <option>San Alejandro</option>
        <option>La Margarita</option>
        <option>24 Sur</option>
        <option>16 de Septiembre</option>
        <option>Clínica Integral</option>
        <option>Amozoc</option>
        <option>Cholula</option>
        <option>105 Pte</option>
      </select>
      <br>
      <label>Tipo de recibo (Requerido)</label>
      <select class="form-control" id="tipo_recibo" formControlName="tipo_recibo" [(ngModel)]="quejasSugerenciasTmp.tipo_recibo" autocomplete="off">
        <option [ngValue]="'Telefono'"selected>Teléfono</option> 
        <option [ngValue]="'Presencial'">Presencial</option>
        <option  [ngValue]="'Email'">Email</option>
        <option [ngValue]="'Redes Sociales'">Redes Sociales</option> 
        <option [ngValue]="'Pagina web'">Pagina web</option>
        <option  [ngValue]="'En Linea'">En Linea</option>
      </select> 
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['tipo_recibo'].touched && quejasSugerenciasForm.controls['tipo_recibo'].errors?.required">Requerido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['tipo_recibo'].touched && quejasSugerenciasForm.controls['tipo_recibo'].errors?.required">     
      <br>  
      <label>Nombre del representante (Requerido)</label>
      <input class="form-control" type="text" placeholder="nombre del presentante" formControlName="nombre_presentante" [(ngModel)]="quejasSugerenciasTmp.nombre_presentante">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['nombre_presentante'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['nombre_presentante'].errors?.minlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['nombre_presentante'].errors?.maxlength">Debe tener menos de 100 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['nombre_presentante'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['nombre_presentante'].errors?.pattern"> No válido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['nombre_presentante'].errors?.pattern">     
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['nombre_presentante'].touched && quejasSugerenciasForm.controls['nombre_presentante'].errors?.required">Requerido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['nombre_presentante'].touched && quejasSugerenciasForm.controls['nombre_presentante'].errors?.required">
      <br>  
      <label>Teléfono (Opcional)</label>
      <input class="form-control" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" placeholder="" formControlName="telefono" [(ngModel)]="quejasSugerenciasTmp.telefono">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['telefono'].errors?.min">No válido</span>
      <br *ngIf="quejasSugerenciasForm.controls['telefono'].errors?.min">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['telefono'].errors?.max">No válido</span>
      <br *ngIf="quejasSugerenciasForm.controls['telefono'].errors?.max">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['telefono'].touched && quejasSugerenciasForm.controls['telefono'].errors?.required">Requerido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['telefono'].touched && quejasSugerenciasForm.controls['telefono'].errors?.required">     
      <br>  
      <label>Correo (Opcional)</label>
      <input autocomplete="off" type="email" id="email" name="email" class="form-control" placeholder="Correo" [(ngModel)]="quejasSugerenciasTmp.email" formControlName="email" (change)="consultarDisponibilidadEmail()">
      <div *ngIf="(pacienteFlag==1 || medicoFlag==1)" style="text-align: center;" class="alert alert-success" role="alert">Este correo ya se encuentra registrado. </div> 
      <div *ngIf="((pacienteFlag==2 || medicoFlag==2) && (this.quejasSugerenciasForm.controls['email'].errors)==null)" style="text-align: center;" class="alert alert-warning" role="alert">Este correo no se encuentra registrado. </div> 
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['email'].errors?.minlength">El correo debe tener mínimo 5 caracteres</span>
      <br *ngIf="quejasSugerenciasForm.controls['email'].errors?.minlength">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['email'].errors?.maxlength">El correo no puede superar los 40 caracteres</span>
      <br *ngIf="quejasSugerenciasForm.controls['email'].errors?.maxlength">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['email'].errors?.pattern">No parece ser un correo válido</span>   
      <br *ngIf="quejasSugerenciasForm.controls['email'].errors?.pattern">
      <br>
      <label>Descripción (Requerido)</label>
      <input class="form-control" type="text" placeholder="Descripción" formControlName="descripcion" [(ngModel)]="quejasSugerenciasTmp.descripcion">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['descripcion'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['descripcion'].errors?.minlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['descripcion'].errors?.maxlength">Debe tener menos de 300 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['descripcion'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['descripcion'].errors?.pattern"> No válido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['descripcion'].errors?.pattern">     
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['descripcion'].touched && quejasSugerenciasForm.controls['descripcion'].errors?.required">Requerido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['descripcion'].touched && quejasSugerenciasForm.controls['descripcion'].errors?.required">
      <br>  
      <label>Nombre del personal (Requerido)</label>
      <input class="form-control" type="text" placeholder="nombre del personal" formControlName="nombre_personal" [(ngModel)]="quejasSugerenciasTmp.nombre_personal">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['nombre_personal'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['nombre_personal'].errors?.minlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['nombre_personal'].errors?.maxlength">Debe tener menos de 100 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['nombre_personal'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['nombre_personal'].errors?.pattern"> No válido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['nombre_personal'].errors?.pattern">     
      <br>  
      <label>Puesto del personal (Requerido)</label>
      <input class="form-control" type="text" placeholder="Puesto del personal" formControlName="puesto_personal" [(ngModel)]="quejasSugerenciasTmp.puesto_personal">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['puesto_personal'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['puesto_personal'].errors?.minlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['puesto_personal'].errors?.maxlength">Debe tener menos de 100 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['puesto_personal'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['puesto_personal'].errors?.pattern"> No válido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['puesto_personal'].errors?.pattern">     
      <br>  
      <label>Fecha de recibo (Requerido)</label>
      <input class="form-control" id="date" type="date" formControlName="fecha_recibo" [(ngModel)]="quejasSugerenciasTmp.fecha_recibo" >
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['fecha_recibo'].errors?.minDate">Esta fecha no es válida</span>
      <br *ngIf="quejasSugerenciasForm.controls['fecha_recibo'].errors?.minDate">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['fecha_recibo'].errors?.maxDate">Esta fecha no es válida</span>
      <br *ngIf="quejasSugerenciasForm.controls['fecha_recibo'].errors?.maxDate">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['fecha_recibo'].touched && quejasSugerenciasForm.controls['fecha_recibo'].errors?.required">Requerido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['fecha_recibo'].touched && quejasSugerenciasForm.controls['fecha_recibo'].errors?.required">     
      <br>
      <label>Notas (Opcional)</label>
      <input class="form-control" type="text" placeholder="Notas" formControlName="notas" [(ngModel)]="quejasSugerenciasTmp.notas">
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['notas'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['notas'].errors?.minlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['notas'].errors?.maxlength">Debe tener menos de 500 caracteres.</span>
      <br *ngIf="quejasSugerenciasForm.controls['notas'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="quejasSugerenciasForm.controls['notas'].errors?.pattern"> No válido.</span>
      <br *ngIf="quejasSugerenciasForm.controls['notas'].errors?.pattern">     
      <br>  
    </form>
    <button type="button" class="btn boton" (click)="c('')">Regresar</button>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <button type="button" class="btn boton"  (click)="c('')" (click)="crearQuejasSugerenciasOp()"  >Guardar</button> 
  </div>
</ng-template>

<ng-template #quejasSugerenciasModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Quejas & sugerencias</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <table id="listaQuej" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
        <thead>
          <tr>            
            <th>Num.</th>
            <th>Tipo.</th>
            <th>Tipo recibo.</th>
            <th>Nombre.</th>
            <th>Fecha.</th>
            <th>Hora.</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let results of quejasSugerencias.results; index as i" (click)="verQuejaSugerencia(results, quejaSugerenciaModal)">
            <td><span >{{results.id}}</span></td>
            <td><span >{{results.tipo}}</span></td>
            <td><span >{{results.tipo_recibo}}</span></td>
            <td><span >{{results.nombre_presentante}}</span></td>
            <td><span >{{results.fecha_evento}}</span></td>
            <td><span >{{results.hora_evento}}</span></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button type="button" class="btn boton" (click)="verNuevoQuejaSujerencia(nuevoQuejaSujerencia)">Nuevo</button>
  </div>
</ng-template>

<ng-template #quejaSugerenciaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Queja & sugerencia</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div *ngIf="quejaSugerencia"> 
      <div class="row">       
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" >
          <p>Id. llamada: <strong>{{quejaSugerencia.id}}</strong></p>
          <p *ngIf="quejaSugerencia.folio">Folio: <strong>{{quejaSugerencia.folio}}</strong></p>
          <p *ngIf="!quejaSugerencia.folio">Folio: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.tipo_recibo">Tipo de recibo: <strong>{{quejaSugerencia.tipo_recibo}}</strong></p>
          <p *ngIf="!quejaSugerencia.tipo_recibo">Tipo de recibo: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.sucursal">Sucursal: <strong>{{quejaSugerencia.sucursal}}</strong></p>
          <p *ngIf="!quejaSugerencia.sucursal">Sucursal: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.tipo_recibo">Tipo de recibo: <strong>{{quejaSugerencia.tipo_recibo}}</strong></p>
          <p *ngIf="!quejaSugerencia.tipo_recibo">Tipo de recibo: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.nombre_presentante">Nombre paciente: <strong>{{quejaSugerencia.nombre_presentante}}</strong></p>
          <p *ngIf="!quejaSugerencia.nombre_presentante">Nombre paciente: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.telefono">Teléfono: <strong>{{quejaSugerencia.telefono}}</strong></p>
          <p *ngIf="!quejaSugerencia.telefono">Teléfono: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.email">Email: <strong>{{quejaSugerencia.email}}</strong></p>
          <p *ngIf="!quejaSugerencia.email">email: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.fecha_evento">Fecha Evento: <strong>{{quejaSugerencia.fecha_evento}}</strong></p>
          <p *ngIf="!quejaSugerencia.fecha_evento">Fecha Evento: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.hora_evento">Hora: <strong>{{quejaSugerencia.hora_evento}}</strong></p>
          <p *ngIf="!quejaSugerencia.hora_evento">Hora: <strong >No definido</strong></p>
          <hr>
          <p *ngIf="quejaSugerencia.descripcion">Descripción: <strong>{{quejaSugerencia.descripcion}}</strong></p>
          <p *ngIf="!quejaSugerencia.descripcion">Descripción: <strong >No definido</strong></p>
          <hr *ngIf="quejaSugerencia.notas"> 
          <label *ngIf="quejaSugerencia.notas" style="font-size: 1.0em;" ><strong>Notas</strong></label>
          <br *ngIf="quejaSugerencia.notas"><br *ngIf="quejaSugerencia.notas">
          <p *ngIf="quejaSugerencia.notas">Notas: <strong>{{quejaSugerencia.notas}}</strong></p>
          <hr>
          <label style="font-size: 1.0em;" ><strong>Personal responsable</strong></label>
          <br><br>
          <p *ngIf="quejaSugerencia.puesto_personal">Nombre del personal: <strong>{{quejaSugerencia.nombre_personal}}</strong></p>
          <p *ngIf="!quejaSugerencia.nombre_personal">Nombre del personal: <strong >No definido</strong></p>		  
          <p *ngIf="quejaSugerencia.puesto_personal">Puesto del personal: <strong>{{quejaSugerencia.puesto_personal}}</strong></p>
          <p *ngIf="!quejaSugerencia.puesto_personal">Puesto del personal: <strong >No definido</strong></p>
          <p *ngIf="quejaSugerencia.fecha_recibo">Fecha de recibo: <strong>{{quejaSugerencia.fecha_recibo}}</strong></p>
          <p *ngIf="!quejaSugerencia.fecha_recibo">Fecha de recibo: <strong >No definido</strong></p>
          <hr> 
          <div *ngIf="quejaSugerencia.nombre_encargado">
            <label style="font-size: 1.0em;" ><strong>Resolución</strong></label>
            <br><br>
            <p *ngIf="quejaSugerencia.nombre_encargado">Nombre_encargado: <strong>{{quejaSugerencia.nombre_encargado}}</strong></p>
            <p *ngIf="!quejaSugerencia.nombre_encargado">Nombre del encargado: <strong >No definido</strong></p>
            <p *ngIf="quejaSugerencia.puesto_encargado">Puesto del encargado: <strong>{{quejaSugerencia.puesto_encargado}}</strong></p>
            <p *ngIf="!quejaSugerencia.puesto_encargado">Puesto del encargado: <strong >No definido</strong></p>
            <p *ngIf="quejaSugerencia.fecha_encargado">Fecha de recepción: <strong>{{quejaSugerencia.fecha_encargado}}</strong></p>
            <p *ngIf="!quejaSugerencia.fecha_encargado">Fecha de recepción: <strong >No definido</strong></p>
            <p *ngIf="quejaSugerencia.procede">Procede: <strong>{{quejaSugerencia.procede}}</strong></p>
            <p *ngIf="!quejaSugerencia.procede">Procede: <strong >No definido</strong></p>
            <p *ngIf="quejaSugerencia.recurrente">Recurrente: <strong>{{quejaSugerencia.recurrente}}</strong></p>
            <p *ngIf="!quejaSugerencia.recurrente">Recurrente: <strong >No definido</strong></p>
            <hr>
          </div>
          <label style="font-size: 1.0em;" ><strong>Registro</strong></label>
          <br><br>
          <p *ngIf="quejaSugerencia.creador">Creador: <strong>{{quejaSugerencia.creador}}</strong></p>
          <p *ngIf="!quejaSugerencia.creador">Creador: <strong>No definido</strong></p>
          <p *ngIf="quejaSugerencia.editor">Editor: <strong>{{quejaSugerencia.editor}}</strong></p>
          <p *ngIf="!quejaSugerencia.editor">Editor: <strong>No definido</strong></p>
          <p *ngIf="quejaSugerencia.creacion">Creación: <strong>{{quejaSugerencia.creacion.substring(0,10)}} {{quejaSugerencia.creacion.substring(11,16)}}</strong></p>
          <p *ngIf="!quejaSugerencia.creacion">Creación: <strong>No definido</strong></p>
          <p *ngIf="quejaSugerencia.ultimaActualizacion">Última Actualización: <strong>{{quejaSugerencia.ultimaActualizacion.substring(0,10)}} {{quejaSugerencia.ultimaActualizacion.substring(11,16)}}</strong></p>
          <p *ngIf="!quejaSugerencia.ultimaActualizacion">Última Actualización: <strong>No definido</strong></p>                     
        </div>
      </div>
    </div>
    <button type="button" class="btn boton" (click)="c('')">Regresar</button>
    &nbsp;&nbsp;&nbsp;&nbsp; 
    <button *ngIf="empleado.directivo" type="button" class="btn boton" (click)="purgarQueja()" (click)="verEstudios(editarQuejaSujerencia)">Resolución</button>
  </div>  
</ng-template>

<ng-template #editarQuejaSujerencia let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Editar queja & sugerencia</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <form [formGroup]="editarQuejasSugerenciasForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> 

      <label>Recurrente (Requerido)</label>
      <select class="form-control" id="recurrente" formControlName="recurrente" [(ngModel)]="quejasSugerenciasTmp.recurrente" autocomplete="off">
        <option [ngValue]="'SI'"selected>SI</option> 
        <option [ngValue]="'NO'">NO</option>
      </select> 
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['recurrente'].touched && editarQuejasSugerenciasForm.controls['recurrente'].errors?.required">Requerido.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['recurrente'].touched && editarQuejasSugerenciasForm.controls['recurrente'].errors?.required">     
      <br>  
      <label>Procede (Requerido)</label>
      <select class="form-control" id="procede" formControlName="procede" [(ngModel)]="quejasSugerenciasTmp.procede" autocomplete="off">
        <option [ngValue]="'SI'"selected>SI</option> 
        <option [ngValue]="'NO'">NO</option>
      </select> 
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['procede'].touched && editarQuejasSugerenciasForm.controls['procede'].errors?.required">Requerido.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['procede'].touched && editarQuejasSugerenciasForm.controls['procede'].errors?.required">     
      <br>  
      <label>Nombre del encargado (Requerido)</label>
      <input class="form-control" type="text" placeholder="Nombre de Paciente" formControlName="nombre_encargado" [(ngModel)]="quejasSugerenciasTmp.nombre_encargado">
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['nombre_encargado'].errors?.minlength">Nombre de Paciente debe tener al menos 5 caracteres</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['nombre_encargado'].errors?.minlength">
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['nombre_encargado'].errors?.maxlength">Nombre de Paciente debe tener menos de 150 caracteres</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['nombre_encargado'].errors?.maxlength">
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['nombre_encargado'].errors?.pattern">No válido</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['nombre_encargado'].errors?.pattern">
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['nombre_encargado'].touched && editarQuejasSugerenciasForm.controls['nombre_encargado'].errors?.required">Requerido.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['nombre_encargado'].touched && editarQuejasSugerenciasForm.controls['nombre_encargado'].errors?.required">
      <br>
      <label>Puesto del encargado (Requerido)</label>
      <input class="form-control" type="text" placeholder="Puesto del personal" formControlName="puesto_encargado" [(ngModel)]="quejasSugerenciasTmp.puesto_encargado">
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['puesto_encargado'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['puesto_encargado'].errors?.minlength">  
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['puesto_encargado'].errors?.maxlength">Debe tener menos de 40 caracteres.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['puesto_encargado'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['puesto_encargado'].errors?.pattern"> No válido.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['puesto_encargado'].errors?.pattern">     
      <br>  
      <label>Fecha de Encargado (Requerido)</label>
      <input class="form-control" id="date" type="date" formControlName="fecha_encargado" [(ngModel)]="quejasSugerenciasTmp.fecha_encargado" >
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['fecha_encargado'].errors?.minDate">Esta fecha no es válida</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['fecha_encargado'].errors?.minDate">
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['fecha_encargado'].errors?.maxDate">Esta fecha no es válida</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['fecha_encargado'].errors?.maxDate">
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['fecha_encargado'].touched && editarQuejasSugerenciasForm.controls['fecha_encargado'].errors?.required">Requerido.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['fecha_encargado'].touched && editarQuejasSugerenciasForm.controls['fecha_encargado'].errors?.required">     
      <br>
      <label>Notas (Opcional)</label>
      <input class="form-control" type="text" placeholder="Notas" formControlName="notas" [(ngModel)]="quejasSugerenciasTmp.notas">
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['notas'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['notas'].errors?.minlength">  
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['notas'].errors?.maxlength">Debe tener menos de 500 caracteres.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['notas'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="editarQuejasSugerenciasForm.controls['notas'].errors?.pattern"> No válido.</span>
      <br *ngIf="editarQuejasSugerenciasForm.controls['notas'].errors?.pattern">  
      <br>  
    </form>
    <button type="button" class="btn boton" (click)="c('')">Regresar</button>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <button type="button" class="btn boton" (click)="c('')"  (click)="editarQuejasSugerenciasOp()">Guardar</button> 
  </div>
</ng-template>



<ng-template #editarComentario let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Editar comentario</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <form [formGroup]="editarComentarioNotaForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> 
      <label>Notas (Opcional)</label>
      <input class="form-control" type="text" placeholder="Notas" formControlName="notas" [(ngModel)]="comentarioTmp.notas">
      <span style="color:Red;" *ngIf="editarComentarioNotaForm.controls['notas'].errors?.minlength">Debe tener mas de 3 caracteres.</span>
      <br *ngIf="editarComentarioNotaForm.controls['notas'].errors?.minlength">  
      <span style="color:Red;" *ngIf="editarComentarioNotaForm.controls['notas'].errors?.maxlength">Debe tener menos de 500 caracteres.</span>
      <br *ngIf="editarComentarioNotaForm.controls['notas'].errors?.maxlength">  
      <span style="color:Red;" *ngIf="editarComentarioNotaForm.controls['notas'].errors?.pattern"> No válido.</span>
      <br *ngIf="editarComentarioNotaForm.controls['notas'].errors?.pattern">  
      <br>  
    </form>
    <button type="button" class="btn boton" (click)="c('')">Regresar</button>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <button type="button" class="btn boton" (click)="c('')"  (click)="editarComentariosOp()">Guardar</button> 
  </div>
</ng-template>

<ng-template #facturacionModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Facturación</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <table id="listaFac" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>Num.</th>
            <th>Estatus.</th>
            <th>Nombre.</th>
            <th>Tipo RFC.</th>
            <th>RFC.</th>
            <th>Creación</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let results of facturacion.results; index as i" (click)="verFactura(results, facturaModal)">
            <td><span >{{results.id}}</span></td>
            <td><span >{{results.factura_estatus}}</span></td>
            <td><span >{{results.apellido_paterno}} {{results.apellido_materno}} {{results.nombre.substr(0,30)}}</span></td>
            <td><span >{{results.tipo_rfc}}</span></td>
            <td><span >{{results.rfc}}</span></td>
            <td><span >{{results.creacion.substring(0,10)}} {{results.creacion.substring(11,16)}}</span></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button *ngIf="!this.empleado.auditor" type="button" class="btn boton" (click)="purgarFactura()" (click)="verEstudios(nuevaFacturaModal)">Nueva Factura</button>
      <button *ngIf="this.empleado.auditor" type="button" class="btn boton" disabled>Nueva Factura</button>
  </div>
</ng-template>


<ng-template #llamadasModal let-c="close" led-d="dismiss">
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Call Center</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <table id="listaCall" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>Num.</th>
            <th>Tipo</th>
            <th>Cliente</th>
            <th>Creador</th>
            <th>Creación</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let results of calls.results; index as i" (click)="verLlamada(results, llamadaModal)">
            <td><span >{{results.id}}</span></td>
            <td><span >{{results.tipo}}</span></td>
            <td *ngIf="!results.nombre"><span >No definido </span></td>
            <td *ngIf="results.nombre"><span >{{results.nombre}} {{results.apellido_paterno}} {{results.apellido_materno}}</span></td>
            <td *ngIf="!results.creador"><span >No definido </span></td>
            <td *ngIf="results.creador"><span >{{results.creador}}</span></td>
            <td><span >{{results.creacion.substring(0,10)}} {{results.creacion.substring(11,16)}}</span></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button *ngIf="!this.empleado.auditor" type="button" class="btn boton" (click)="purgarLlamada()" (click)="verEstudios(nuevaLlamadaModal)">Nueva Llamada</button>
      <button *ngIf="this.empleado.auditor" type="button" class="btn boton" disabled>Nueva Llamada</button>
  </div>
</ng-template>

<ng-template #llamadaModal let-c="close" led-d="dismiss">
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Call Center</h4>   
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div *ngIf="call"> 
      <div class="row">       
        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" >
          <p>Id. Llamada: <strong>{{call.id}}</strong></p>
          <p>Tipo: <strong style="color:#FF0000;">{{call.tipo}}</strong></p>
          <p *ngIf="call.telefono">Teléfono: <strong >{{call.telefono}}</strong></p> 
          <p *ngIf="!call.telefono">Teléfono: <strong >No definido</strong></p>
          <p *ngIf="call.interes">Área de Interés: <strong >{{call.interes}}</strong></p>
          <p *ngIf="!call.interes">Área de Interés: <strong >No definido</strong></p>
          <p *ngIf="call.nombre">Nombre: <strong >{{call.nombre}} {{call.apellido_paterno}} {{call.apellido_materno}}</strong></p>
          <p *ngIf="!call.nombre">Nombre: <strong >No definido</strong></p>
          <p *ngIf="call.email">Email: <strong >{{call.email}}</strong></p>
          <p *ngIf="!call.email">Email: <strong >No definido</strong></p>
          <p *ngIf="call.fecha_nacimiento">Fecha nacimiento: <strong >{{call.fecha_nacimiento}}</strong></p>
          <p *ngIf="!call.fecha_nacimiento">Fecha nacimiento: <strong >No definido</strong></p>
          <hr>
          <p *ngIf="call.experiencia">Experiencia: <strong>{{call.experiencia}}</strong></p>
          <p *ngIf="!call.experiencia">Experiencia: <strong>No definido</strong></p>
          <hr>
          <p *ngIf="call.creador">Creador: <strong>{{call.creador}}</strong></p>
          <p *ngIf="!call.creador">Creador: <strong>No definido</strong></p>
          <p *ngIf="call.editor">Editor: <strong>{{call.editor}}</strong></p>
          <p *ngIf="!call.editor">Editor: <strong>No definido</strong></p>
          <p *ngIf="call.creacion">Creación: <strong>{{call.creacion.substring(0,10)}} {{call.creacion.substring(11,16)}}</strong></p>
          <p *ngIf="!call.creacion">Creación: <strong>No definido</strong></p>
          <p *ngIf="call.ultimaActualizacion">Última Actualización: <strong>{{call.ultimaActualizacion.substring(0,10)}} {{call.ultimaActualizacion.substring(11,16)}}</strong></p>
          <p *ngIf="!call.ultimaActualizacion">Última Actualización: <strong>No definido</strong></p>                     
          <button type="button" class="btn boton" (click)="c('')">Regresar</button>
        </div>
      </div>
    </div>
  </div>
</ng-template>


<ng-template #nuevaLlamadaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Nueva Llamada</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div class="row">
      <form [formGroup]="LlamadaCrearForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> 
        <label class="editar" >Tipo (Requerido)</label>
        <select class="form-control" id="tipo" formControlName="tipo" [(ngModel)]="callTmp.tipo" (change)="tipoLlamada()">
          <option [ngValue]="'CALIDAD'"selected>Calidad de servicio</option>
          <option [ngValue]="'RECIBIDA'">Llamada recibida</option>
        </select>
	      <br *ngIf="LlamadaCrearForm.controls['tipo'].touched && LlamadaCrearForm.controls['tipo'].errors?.required">
	      <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['tipo'].touched && LlamadaCrearForm.controls['tipo'].errors?.required">Requerido.</span>
        <br>
	    	<label>Teléfono (Requerido)</label>
        <input class="form-control" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" placeholder="" formControlName="telefono" [(ngModel)]="facturaTmp.telefono">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['telefono'].errors?.min">Número no válido</span>
        <br *ngIf="LlamadaCrearForm.controls['telefono'].errors?.min">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['telefono'].errors?.max">Número no válido</span>
        <br *ngIf="LlamadaCrearForm.controls['telefono'].errors?.max">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['telefono'].touched && LlamadaCrearForm.controls['telefono'].errors?.required">Requerido.</span>
        <br *ngIf="LlamadaCrearForm.controls['telefono'].touched && LlamadaCrearForm.controls['telefono'].errors?.required">     
        <br>  
    		<label class="editar" >Área de interés (Requerido)</label>
        <input class="form-control" type="text" placeholder="interes" formControlName="interes"  autocomplete="off" [(ngModel)]="callTmp.interes">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['interes'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['interes'].errors?.minlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['interes'].errors?.maxlength">No debe ser de mas de 500 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['interes'].errors?.maxlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['interes'].touched && LlamadaCrearForm.controls['interes'].errors?.required">Requerido.</span>
        <br *ngIf="LlamadaCrearForm.controls['interes'].touched && LlamadaCrearForm.controls['interes'].errors?.required">
        <br>
        <label class="editar" >Nombre (Opcional)</label>
        <input class="form-control" type="text" placeholder="Nombre" formControlName="nombre"  autocomplete="off" [(ngModel)]="callTmp.nombre">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['nombre'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['nombre'].errors?.minlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['nombre'].errors?.maxlength">No debe ser de mas de 90 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['nombre'].errors?.maxlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['nombre'].errors?.pattern">No parece ser un nombre válido</span>
        <br *ngIf="LlamadaCrearForm.controls['nombre'].errors?.pattern">
        <br>
        <label class="editar">Apellido Paterno (Opcional)</label>
        <input class="form-control" type="text" placeholder="Primer Apellido" formControlName="apellido_paterno" [(ngModel)]="callTmp.apellido_paterno">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['apellido_paterno'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['apellido_paterno'].errors?.minlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['apellido_paterno'].errors?.maxlength">No debe ser de mas de 45 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['apellido_paterno'].errors?.maxlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['apellido_paterno'].errors?.pattern">No parece ser un apellido válido</span>
        <br *ngIf="LlamadaCrearForm.controls['apellido_paterno'].errors?.pattern">
        <br>
        <label class="editar">Apellido Materno (Opcional)</label>
        <input class="form-control" type="text" placeholder="Segundo Apellido" formControlName="apellido_materno" [(ngModel)]="callTmp.apellido_materno">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['apellido_materno'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['apellido_materno'].errors?.minlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['apellido_materno'].errors?.maxlength">No debe ser de mas de 45 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['apellido_materno'].errors?.maxlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['apellido_materno'].errors?.pattern">No parece ser un apellido válido</span>
        <br *ngIf="LlamadaCrearForm.controls['apellido_materno'].errors?.pattern">
        <br> 
	    	<label>Correo (Opcional)</label>
        <input autocomplete="off" type="email" id="email" name="email" class="form-control" placeholder="Correo" [(ngModel)]="callTmp.email" formControlName="email" (change)="consultarDisponibilidadEmail()">
        <div *ngIf="(pacienteFlag==1 || medicoFlag==1)" style="text-align: center;" class="alert alert-success" role="alert">Este correo ya se encuentra registrado. </div> 
        <div *ngIf="((pacienteFlag==2 || medicoFlag==2) && (this.LlamadaCrearForm.controls['email'].errors)==null)" style="text-align: center;" class="alert alert-warning" role="alert">Este correo no se encuentra registrado. </div> 
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['email'].errors?.minlength">El correo debe tener mínimo 5 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['email'].errors?.minlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['email'].errors?.maxlength">El correo no puede superar los 40 caracteres</span>
        <br *ngIf="LlamadaCrearForm.controls['email'].errors?.maxlength">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['email'].errors?.pattern">No parece ser un correo válido</span>   
        <br *ngIf="LlamadaCrearForm.controls['email'].errors?.pattern">
        <br>
    		<label>Fecha de Nacimiento (Opcional)</label>
        <input class="form-control" id="date" type="date" formControlName="fecha_nacimiento" [(ngModel)]="callTmp.fecha_nacimiento" >
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['fecha_nacimiento'].errors?.minDate">Esta fecha no es válida</span>
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['fecha_nacimiento'].errors?.maxDate">Esta fecha no es válida</span>
        <br>
        <label>Experiencia (Opcional)</label>
        <textarea *ngIf="calidadFlag==1 || calidadFlag==0" class="form-control" type="text" placeholder="Experiencia" formControlName="experiencia"  maxlength="2000" [(ngModel)]="callTmp.experiencia" rows="5"></textarea>
        <textarea *ngIf="calidadFlag==2" class="form-control" type="text" placeholder="Experiencia" formControlName="experiencia"  maxlength="2000" [(ngModel)]="callTmp.experiencia" rows="5" disabled></textarea>
        <span *ngIf="callTmp.experiencia">Caracteres Restantes: {{2000-callTmp.experiencia.length}}</span>
        <br *ngIf="callTmp.experiencia">
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['experiencia'].errors?.minlength">Debe tener mas de 5 caracteres.</span>
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['experiencia'].errors?.maxlength">Debe tener menos de 1000 caracteres.</span>
        <span style="color:Red;" *ngIf="LlamadaCrearForm.controls['experiencia'].errors?.pattern"> No válido.</span>
        <br>
      </form>
    </div> 
    <div class="botones">
      <button type="button" class="btn boton" style="background-color:red" data-dismiss="modal" (click)="c('')">Cerrar</button>
      <a>&nbsp;&nbsp;&nbsp;&nbsp;</a>
      <button type="button" class="btn boton" (click)="crearLlamada()"  (click)="c('')" [disabled]="LlamadaCrearForm.invalid">Guardar</button> 
      <a>&nbsp;&nbsp;&nbsp;&nbsp;</a>
      <!-- 
      <button *ngIf="(callTmp.nombre && callTmp.apellido_paterno && callTmp.email && callTmp.fecha_nacimiento && (pacienteFlag==2 || medicoFlag==2))" type="button" class="btn boton"   (click)="c('')" (click)="verEstudios(contrasenaModal)" [disabled]="LlamadaCrearForm.invalid">Guardar y crear paciente</button> 
      <button *ngIf="!(callTmp.nombre && callTmp.apellido_paterno && callTmp.email && callTmp.fecha_nacimiento)" type="button" class="btn boton" disabled>Guardar y crear paciente</button> 
       -->
    </div>
  </div>
</ng-template>

<ng-template #contrasenaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Crear paciente</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <div class="row">
        <form [formGroup]="PacienteCrearForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> 
          <label class="editar" >Contraseña (Requerido)</label>
          <input class="form-control" type="text" placeholder="password" formControlName="password"  autocomplete="off" [(ngModel)]="PacienteCrearTmp.password">
          <span style="color:Red;" *ngIf="PacienteCrearForm.controls['password'].errors?.minlength">Debe ser de mas de 8 caracteres</span>
          <br *ngIf="PacienteCrearForm.controls['password'].errors?.minlength">
          <span style="color:Red;" *ngIf="PacienteCrearForm.controls['password'].errors?.maxlength">No debe ser de mas de 30 caracteres</span>
          <br *ngIf="PacienteCrearForm.controls['password'].errors?.maxlength">
          <span style="color:Red;" *ngIf="PacienteCrearForm.controls['password'].touched && PacienteCrearForm.controls['password'].errors?.required">Requerido.</span>
          <br *ngIf="PacienteCrearForm.controls['password'].touched && PacienteCrearForm.controls['password'].errors?.required">
          <br *ngIf="queryForm.controls['query'].errors?.pattern">
          <span style="color:Red;" *ngIf="queryForm.controls['query'].errors?.pattern">No válido</span>
          <br>
          <button type="button" class="btn boton" (click)="c('')">Regresar</button>
          <a>&nbsp;&nbsp;&nbsp;&nbsp;</a>
          <button type="button" class="btn boton"   (click)="c('')"  (click)="crearLlamada()" (click)="crearPaciente()"  [disabled]="PacienteCrearForm.invalid">Guardar</button> 
        </form>
      </div>
  </div>
</ng-template>


<ng-template #externasModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Citas Externas</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
      <table id="lista" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th>Num.</th>
            <th>Prueba</th>
            <th>Paciente</th>
            <th>Estatus</th>
            <th>Registro</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let results of citasExt.results; index as i" (click)="verEstudiosExternos(results, citaModal)">
            <td><span >{{results.id}}</span></td>
            <td><span >{{results.prueba.substr(0,40)}}</span></td>
            <td *ngIf="results.Paciente"><span >{{results.Paciente.nombre}} {{results.Paciente.apellido_paterno}} {{results.Paciente.apellido_materno}}</span></td>
            <td *ngIf="!results.Paciente"><span ></span></td>
            <td><span >{{results.estatus}}</span></td>
            <td><span >{{results.creacion.substring(0,10)}} {{results.creacion.substring(11,16)}}</span></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
  </div>
</ng-template>

<ng-template #pruebaModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Seleccionar Prueba</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div class="search-banner text-white py-3" id="search-banner">
            <div >
                <div class="row">
                    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                        <div class="card acik-renk-form">
                            <div class="card-body">
                                <h4 class="titulo">Palabras Clave:</h4>
                                <div class="row">
                                    <div class="col-12 col-sm-12 col-md-10 col-lg-10 col-xl-10">
                                        <div class="form-group" [formGroup]="queryForm">
                                            <input  (keydown)="onKeydown($event)" class="form-control" type="text" style="font-size:20px" placeholder="Buscar estudio:" formControlName="query" [(ngModel)]="query">
                                            <span style="color:Red;" *ngIf="queryForm.controls['query'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
                                            <span style="color:Red;" *ngIf="queryForm.controls['query'].errors?.maxlength">No debe ser de mas de 90 caracteres</span>
                                            <span style="color:Red;" *ngIf="queryForm.controls['query'].touched && queryForm.controls['query'].errors?.required">Campo Requerido.</span>
                                            <br>
                                            <span style="color:Red;" *ngIf="queryForm.controls['query'].errors?.pattern">No válido</span>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-2 col-lg-2 col-xl-2">
                                        <button  style="font-size: 20px;" type="button" (click)="consultarEstudio()" [disabled]="queryForm.invalid" class="btn boton">Buscar</button>
                                        <br>
                                        <br>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                                        <button id="btnboton" type="btn boton" style="background-color: #7C4E26;" (click)="verEstudios(estudiosModal)"> Filtrar por categoría</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="estudios[0]" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" style="color:black;">
                        <br> 
                        <h2 style="text-align: center; font-size: 2.5em;" class="titulo">Resultados:</h2>
                        <br> 
                        <div *ngFor="let results of estudios; index as i">
                            <article class="search-result row articulo">
                            <div class="col-12 col-sm-6 col-md-6 col-lg-6 col-xl-6" style="color:black;">
                            <br>
                                <ul class="meta-search parrafosJustify">
                                    <li><i class="fas fa fa-flask"></i> <span><strong>Área: </strong></span> {{results.area}}</li>
                                    <li><i class="fas fa fa-dollar"></i> <span><strong> Precio Normal: </strong></span>{{results.precioNormal.toFixed(2)}} MXN</li>
                                    <li><i class="fas fa fa-dollar"></i> <span><strong> Precio en Sucursal: </strong></span>{{results.precioApoyo.toFixed(2)}} MXN</li>
                                    <li style="color: green; font-weight: bold"><i class="fas fa fa-dollar"></i> <span><strong> Precio Online: </strong></span>{{results.precioVenta.toFixed(2)}} MXN</li>
                                    <li *ngIf="((((results.precioVenta*100)/results.precioNormal)-100)*-1) > 4.99" style="color: green; font-weight: bold"><i class="fas fa fa-dollar"></i> <span><strong> Mejor Precio: OnLine </strong></span> {{((((results.precioVenta*100)/results.precioNormal)-100)).toFixed(0)}}% de descuento.</li>
                                    <li *ngIf="results.sexo == 'M'"><i class="fas fa fa-male"></i> <span><strong> Sexo: </strong></span><span style="color:#394793;"><strong>Masculino</strong></span></li>
                                    <li *ngIf="results.sexo == 'F'"><i class="fas fa fa-male"></i> <span><strong> Sexo: </strong></span><span style="color:#E4007C;"><strong>Femenino</strong></span></li>
                                    <li *ngIf="results.sexo == 'I'"><i class="fas fa fa-male"></i> <span><strong> Sexo: </strong></span><span style="color:#7C4E26;"><strong>Indistinto</strong></span></li>
                                </ul>
                            </div>
                            <div class="col-12 col-sm-6 col-md-6 col-lg-6 col-xl-6 beneficio">
                                <br>
                                <h3 class="prueba">{{results.prueba.substr(0,60)}}</h3>			
                                <hr>
                                <p class="beneficio">{{results.beneficio}}</p>						
                                <br>
                            </div>
                            &nbsp;&nbsp;
                            <button type="button" style="background-color: #9AB638;" id="btnres" (click)="verEstudiosId(results ,descripcionModal)">Ver Beneficio</button>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <button type="button" style="background-color: #9AB638;" id="btnres" (click)="c('')" (click)="seleccionarCita(results)">Seleccionar</button>
                            </article>
                            <br> 
                        </div>
                    </div>
                    <div *ngIf="!estudios[0]">
                        <div *ngIf="initialFlag">
                            <br> 
                            <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                                <h2 style="font-size: 2.5em;" class="titulo">No hay resultados</h2>
                            </div>
                            <br> 
                        </div>
                    </div>
                </div>
            </div>
        </div>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button>
  </div>
</ng-template>

<ng-template #pacienteModal let-c="close" led-d="dismiss">
  <!-- Modal Header -->
  <div class="modal-header" style="color:white; background-color:#9AB638;">  
      <h4 style="text-align: center;">Seleccionar Paciente</h4>  
      <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
  </div>
  <!-- Modal Body -->
  <div class="modal-body">
    <div *ngIf="pacientes">
      <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
        <table id="lista" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
          <thead>
          <tr>
              <th>Expediente</th>
              <th>Paciente</th>
              <th>sexo</th>
              <th>Fecha Nacimiento</th>
              <th>Email</th>
              <th>Celular</th>
          </tr>
          </thead>
          <tbody>
            <tr *ngFor="let results of pacientes.results; index as i" (click)="seleccionarPaciente(results)" > 
                <td *ngIf="!results.numExpediente"><span >{{results.numExpediente}}</span></td> 
                <td *ngIf="results.numExpediente"><span ></span></td>
                <td ><span >{{results.nombre}} {{results.apellido_paterno}} {{results.apellido_materno}}</span></td>
                <td *ngIf="results.sexo"><span >{{results.sexo}}</span></td>
                <td *ngIf="!results.sexo"><span ></span></td>
                <td *ngIf="results.fecha_nacimiento"><span >{{results.fecha_nacimiento}}</span></td>
                <td *ngIf="!results.fecha_nacimiento"><span ></span></td>
                <td *ngIf="results.email"><span ></span>{{results.email}}</td>
                <td *ngIf="!results.email"><span ></span></td>
                <td *ngIf="results.telefonoCelular"><span >{{results.telefonoCelular}}</span></td>
                <td *ngIf="!results.telefonoCelular"><span ></span></td>
              </tr>
          </tbody>
        </table>
      </div>  
      <br *ngIf="paciente">
      <h6 *ngIf="paciente" class="titulo" style="font-size: 25px; text-align: center;">Paciente Seleccionado: {{paciente.nombre}} {{paciente.apellido_paterno}} {{paciente.apellido_materno}}</h6>
      </div>
      <button type="button" class="btn boton" (click)="c('')">Regresar</button> 
      &nbsp;&nbsp;&nbsp;&nbsp;
      <button *ngIf="paciente" (click)="seleccionarIdPaciente()" (click)="c('')" type="button" class="btn boton" >Seleccionar Paciente</button> 
      <button *ngIf="!paciente" type="button" class="btn boton" disabled>Seleccionar Paciente</button>  
  </div>
</ng-template>

<ng-template #estudiosModal let-c="close" led-d="dismiss">
        <!-- Modal Header -->
        <div class="modal-header" style="color:white; background-color:#9AB638;">  
            <h4>Lista de categorias:</h4>  
            <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
            <div class="row">
                <div class="col-md-12">
                    <label style="color:#9AB638;" class="container">Seleccionar Todos
                        <input type="checkbox"  (click)="selecionarTodos()" [(ngModel)]="todosLista">
                        <span class="checkmark"></span>
                    </label>
                    <br>
                </div>
                <div class="col-md-6">
                    <label style="color:#9AB638 ;" class="container"> Analisis Sanguíneos
                        <input type="checkbox" [(ngModel)]="list[0].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Analisis Clínicos
                        <input type="checkbox" [(ngModel)]="list[1].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Ultrasonografía
                        <input type="checkbox" [(ngModel)]="list[2].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Ultrasonografía Doppler
                        <input type="checkbox" [(ngModel)]="list[3].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Rayos X
                        <input type="checkbox" [(ngModel)]="list[4].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Rayos X Contrastados
                        <input type="checkbox" [(ngModel)]="list[5].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Mastografía
                        <input type="checkbox" [(ngModel)]="list[6].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Papanicolau
                        <input type="checkbox" [(ngModel)]="list[7].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Cardiología
                        <input type="checkbox" [(ngModel)]="list[8].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Tomografía
                        <input type="checkbox" [(ngModel)]="list[9].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Tomografía Contrastada
                        <input type="checkbox" [(ngModel)]="list[10].flag" > 
                        <span class="checkmark"></span>
                    </label>
                </div>
                <div class="col-md-6">
                    <label style="color:#9AB638 ;" class="container"> Resonancia Magnética
                        <input type="checkbox" [(ngModel)]="list[11].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Resonancia Magnética Contrastada
                        <input type="checkbox" [(ngModel)]="list[12].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Colposcopía
                        <input type="checkbox" [(ngModel)]="list[13].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Densitometría
                        <input type="checkbox" [(ngModel)]="list[14].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Audiología
                        <input type="checkbox" [(ngModel)]="list[15].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Espirometría
                        <input type="checkbox" [(ngModel)]="list[16].flag" > 
                        <span class="checkmark"></span>
                    </label>
                    <label style="color:#9AB638 ;" class="container"> Patología
                        <input type="checkbox" [(ngModel)]="list[17].flag" > 
                        <span class="checkmark"></span>
                    </label>
                  </div>
            </div>
            <br>
            <button type="button" class="btn boton"  (click)="c('')">Regresar</button>
        </div>
    </ng-template>

<ng-template #descripcionModal let-c="close" led-d="dismiss">
        <!-- Modal Header -->
        <div class="modal-header" style="color:white; background-color:#9AB638;">  
            <h4 style="text-align: center;">{{estudio.prueba}}</h4>  
            <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
            <div class="row">
                <div class="col-3 col-sm-2 col-md-2 col-lg-2 col-xl-2">
                    <a class="icono" style="color:#394793;" *ngIf="estudio.sexo == 'M'"><i class="fas fa fa-male"></i> </a>
                    <a class="icono" style="color:#E4007C;" *ngIf="estudio.sexo == 'F'"><i class="fas fa fa-female"></i> </a>
                    <a class="icono" style="color:#7C4E26;" *ngIf="estudio.sexo == 'I'"><i class="fas fa fa-group"></i> </a>
                </div>
                <div class="col-9 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                    <span><strong> Precio Normal: </strong></span>{{estudio.precioNormal.toFixed(2)}} MXN
                    <span><strong> Precio en Sucursal: </strong></span>{{estudio.precioApoyo.toFixed(2)}} MXN
                    <div style="color: green; font-weight: bold"> <span><strong> Precio Online: </strong></span>{{estudio.precioVenta.toFixed(2)}} MXN</div>
                    <div *ngIf="((((estudio.precioVenta*100)/estudio.precioNormal)-100)*-1) > 4.99" style="color: green; font-weight: bold"><span><strong> Mejor Precio: OnLine </strong></span> {{((((estudio.precioVenta*100)/estudio.precioNormal)-100)).toFixed(0)}}% de descuento.</div>
                    <br>
                    <a *ngIf="estudio.sexo == 'M'"> <span><strong> Sexo: </strong></span><span >Masculino</span></a>
                    <a *ngIf="estudio.sexo == 'F'"> <span><strong> Sexo: </strong></span><span >Femenino</span></a>
                    <a *ngIf="estudio.sexo == 'I'"> <span><strong> Sexo: </strong></span><span >Indistinto</span></a>
                    <br>
                    <br>  
                </div> 
                <div class="col-12 col-sm-5 col-md-5 col-lg-5 col-xl-5">
                    <span><strong>Area: </strong></span>{{estudio.area}}
                    <br>
                    <span><strong>Sin/Acro: </strong></span>{{estudio.sinAcro}}
                    <br>
                    <br>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                    <hr>
                    <span><strong>Descripción: </strong></span><br>{{estudio.beneficio}}
                    <br>
                    <br>
                    <span><strong>Indicaciones Pre-Examen: </strong></span><br>{{estudio.indicacionesPreExamen}}
                    <br>
                    <br>
                    <span><strong>Tiempo de Entrega: </strong></span><br>{{estudio.tiempoEntrega}}
                    <br>
                    <br>
                </div>
            </div>
            <button type="button" class="btn boton" (click)="c('')">Regresar</button> 
        </div>
    </ng-template>


    <ng-template #EstudioEmpresaModal let-c="close" led-d="dismiss">
      <!-- Modal Header -->
      <div class="modal-header" style="color:white; background-color:#9AB638;">  
          <h4 style="text-align: center;">Detalle de estudio</h4>  
          <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
      </div>
      <!-- Modal Body -->
      <div class="modal-body">
        <div *ngIf="estudioEmpresa"> 
          <div class="row">       
            <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" >
              <p><strong>Id :</strong>{{estudioEmpresa.id}}</p>
              <p *ngIf="estudioEmpresa.caducidad"><strong>Caducidad : </strong>{{estudioEmpresa.caducidad}}</p>
              <p *ngIf="!estudioEmpresa.caducidad"><strong>Caducidad : </strong>No definido</p>  
              <p *ngIf="estudioEmpresa.Paciente"><strong>Nombre: </strong>{{estudioEmpresa.Paciente.nombre}} {{estudioEmpresa.Paciente.apellido_paterno}} {{estudioEmpresa.Paciente.apellido_materno}} </p>
              <p *ngIf="!estudioEmpresa.Paciente"><strong>Nombre: </strong>No definido</p>
              <p *ngIf="estudioEmpresa.Empresa"><strong>Empresa: </strong>{{estudioEmpresa.Empresa.nombreEmpresa}}</p>
              <p *ngIf="!estudioEmpresa.Empresa"><strong>Empresa: </strong>No definido</p>
              <p *ngIf="estudioEmpresa.nombreEstudio"><strong>Nombre de estudio: </strong>{{estudioEmpresa.nombreEstudio}}</p>
              <p *ngIf="!estudioEmpresa.nombreEstudio"><strong>Nombre de estudio: </strong>No definido</p>
              <p *ngIf="estudioEmpresa.categoria"><strong>Categoría: </strong>{{estudioEmpresa.categoria}}</p>
              <p *ngIf="!estudioEmpresa.categoria"><strong>Nombre de esttudio: </strong>No definido</p>
              <p *ngIf="estudioEmpresa.usuario"><strong>Usuario: </strong>{{estudioEmpresa.usuario}}</p>
              <p *ngIf="!estudioEmpresa.usuario"><strong>Usuario: </strong>No definido</p>
              <p *ngIf="estudioEmpresa.solicitud"><strong>Solicitud : </strong>{{estudioEmpresa.solicitud}}</p>
              <p *ngIf="!estudioEmpresa.solicitud"><strong>Solicitud : </strong>No definido</p>
              <br>
              <p style="color:#9AB638; font-size: 20px;"><strong>Detalle: </strong></p>
              <p *ngIf="estudioEmpresa.creador"><strong>Creador : </strong>{{estudioEmpresa.creador}}</p>
              <p *ngIf="!estudioEmpresa.creador"><strong>Creador : </strong>No definido</p>
              <p *ngIf="estudioEmpresa.editor"><strong>Editor : </strong>{{estudioEmpresa.editor}}</p>
              <p *ngIf="!estudioEmpresa.editor"><strong>Editor : </strong>No definido</p>
              <p *ngIf="estudioEmpresa.creacion"><strong>creacion : </strong>{{estudioEmpresa.creacion.split('T')[0]}} {{estudioEmpresa.creacion.substring(11,19)}}</p>
              <p *ngIf="estudioEmpresa.ultimaActualizacion"><strong>Última actualización : </strong>{{estudioEmpresa.ultimaActualizacion.split('T')[0]}} {{estudioEmpresa.ultimaActualizacion.substring(11,19)}}</p>
              <br>
            </div> 
          </div>
          <button type="button" class="btn boton" (click)="c('')">Regresar</button> 
        </div>
      </div>
  </ng-template>




    <ng-template #nuevoEstudioEmpresaModal let-c="close" led-d="dismiss"> 
    <!-- Modal Header -->
    <div class="modal-header" style="color:white; background-color:#9AB638;">  
        <h4 style="text-align: center;">Subir Estudio</h4>  
        <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
    </div>
    <!-- Modal Body -->
    <div class="modal-body">
        <form [formGroup]="estudioEmpresaForm">  
            <label>Usuario (Requerido)</label>
            <input class="form-control" type="text" placeholder="Usuario" formControlName="usuario"  [(ngModel)]="estudioEmpresaTmp.usuario">
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['usuario'].errors?.minlength">Debe ser de mas de 6 caracteres</span>
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['usuario'].errors?.maxlength">No debe ser de mas de 14 caracteres</span>
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['usuario'].touched && estudioEmpresaForm.controls['usuario'].errors?.required">Campo Requerido.</span>
            <br *ngIf="estudioEmpresaForm.controls['usuario'].errors?.pattern">
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['usuario'].errors?.pattern">No válido</span>
            <br>
            <label>Password (Requerido)</label>
            <input class="form-control" type="text" placeholder="Password" formControlName="password"  [(ngModel)]="estudioEmpresaTmp.password">
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['password'].errors?.minlength">Debe ser de mas de 11 caracteres</span>
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['password'].errors?.maxlength">No debe ser de mas de 14 caracteres</span>
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['password'].touched && estudioEmpresaForm.controls['password'].errors?.required">Campo Requerido.</span>
            <br *ngIf="estudioEmpresaForm.controls['password'].errors?.pattern">
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['password'].errors?.pattern">No válido</span>
            <br>
            <label >Solicitud (Requerido)</label> 
            <input class="form-control" placeholder="Solicitud" onkeydown="javascript: return event.keyCode == 69 ? false : true" type="number" formControlName="solicitud" [(ngModel)]="estudioEmpresaTmp.solicitud" >
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['solicitud'].errors?.min">Valor mínimo superado</span>
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['solicitud'].errors?.max">Valor máximo superado</span>
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['solicitud'].touched && estudioEmpresaForm.controls['solicitud'].errors?.required">Campo Requerido.</span>
            <br>
            <label>Categoría (Requerido)</label>
            <select  [(ngModel)]="estudioEmpresaTmp.categoria" placeholder="Seleccionar Categoría..." class="custom-select mr-sm-2" id="inlineFormCustomSelect" formControlName="categoria" autocomplete="off">
            <option value="Analisis Sanguineos" >Analisis Sanguíneos</option>
            <option value="Analisis Clinicos" >Analisis Clínicos</option>
            <option value="Ultrasonografia" >Ultrasonografía</option>
            <option value="Ultrasonografia Doppler" >Ultrasonografía Doppler</option>
            <option value="Rayos X" >Rayos X</option>
            <option value="Rayos X Contrastados" >Rayos X Contrastados</option>
            <option value="Mastografia" >Mastografía</option>
            <option value="Papanicolau" >Papanicolau</option>
            <option value="Tomografia" >Tomografía</option>
            <option value="Tomografia Contrastada" >Tomografía Contrastada</option>
            <option value="Resonancia Magnetica" >Resonancia Magnética</option>
            <option value="Resonancia Magnetica Contrastada" >Resonancia Magnética Contrastada</option>
            <option value="Colposcopia" >Colposcopía</option>
            <option value="Densitometria" >Densitometría</option>
            <option value="Audiologia" >Audiología</option>
            <option value="Espirometria" >Espirometría</option>
            <option value="Cardiologia" >Cardiología</option>
            <option value="Patologia" >Patología</option>
            <option value="Consulta" >Consulta</option>
            <option value="Ginecologia" >Ginecología</option>
            <option value="Rehabilitacion" >Rehabilitacion</option>
            </select> 
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['categoria'].touched && estudioEmpresaForm.controls['categoria'].errors?.required">Campo Requerido.</span>
            <br>
            <br>
            <label>Nombre del estudio (Requerido)</label>
            <input class="form-control" type="text" placeholder="Nombre del estudio" formControlName="nombreEstudio"  [(ngModel)]="estudioEmpresaTmp.nombreEstudio">
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['nombreEstudio'].errors?.minlength">Debe ser de mas de 3 caracteres</span>
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['nombreEstudio'].errors?.maxlength">No debe ser de mas de 1000 caracteres</span>
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['nombreEstudio'].touched && estudioEmpresaForm.controls['nombreEstudio'].errors?.required">Campo Requerido.</span>
            <br *ngIf="estudioEmpresaForm.controls['nombreEstudio'].errors?.pattern">
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['nombreEstudio'].errors?.pattern">No válido</span>
            <br>
            <label>Caducidad (Opcional)</label>
            <input class="form-control" id="date" type="date" formControlName="caducidad" [(ngModel)]="estudioEmpresaTmp.caducidad" >
            <span style="color:Red;" *ngIf="estudioEmpresaForm.controls['caducidad'].errors?.minDate">Esta fecha no es válida</span>
            <br>
            <hr>
            <label>Empresa (Opcional)</label>
            <input class="form-control" type="text" placeholder="Empresa" formControlName="Empresa"  [(ngModel)]="estudioEmpresaTmp.Empresa" readonly>
            <br>
            <button type="button" class="btn boton" (click)="consultarEmpresasOp()" (click)="verEstudios(seleccionarEmpresaModal)">Seleccionar Empresa</button>
            <br>
            <hr>
            <label>Paciente (Requerido)</label>
            <input class="form-control" type="text" placeholder="Paciente" formControlName="Paciente"  [(ngModel)]="estudioEmpresaTmp.Paciente" readonly>
            <br>
            <button type="button" class="btn boton" (click)="purgarBuscarPaciente()" (click)="verEstudios(seleccionarPacienteNombreModal)">Seleccionar Paciente</button>
            <br>
            <hr>
            <label>Selecciona el archivo (Requerido)</label>
            <br>
            <br>
            <!-- Front -->
            <input type="file"accept="application/pdf" (change)="onFileSelect($event)" />
            <br><br>
            <hr>
            <div *ngIf="estudioEstatus==1" class="alert alert-primary" role="alert">Espere...</div>
            <div *ngIf="estudioEstatus==2" class="alert alert-success" role="alert">Estudio Guardado Exitosamente</div>
            <div  *ngIf="estudioEstatus==3" class="alert alert-danger" role="alert">Error: {{msgError}}</div>
        </form>
        <button type="button" class="btn boton" (click)="c('')">Regresar</button>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button type="button" class="btn boton" (click)="print()">Print</button>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <button *ngIf="estudioEstatus==0" style="font-size: 20px;" type="button"  (click)="subirEstudioEmpresaOp()" [disabled]="estudioEmpresaForm.invalid" class="btn boton">Subir</button>
    </div>
    </ng-template>



    <ng-template #seleccionarEmpresaModal let-c="close" led-d="dismiss"> 
        <!-- Modal Header -->
        <div class="modal-header" style="color:white; background-color:#9AB638;">  
            <h4 style="text-align: center;">Selecciona empresa</h4>  
            <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
            <div *ngIf="empresas">
                <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                    <table id="listaEmpresas" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                      <thead>
                      <tr>
                          <th>ID.</th>
                          <th>Nombre</th>
                      </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let results of empresas.results; index as i" (click)="seleccionarEmpresa(results)" > 
                            <td ><span >{{results.id}}</span></td>
                            <td ><span >{{results.nombreEmpresa}}</span></td>
                          </tr>
                      </tbody>
                    </table>
                  <br *ngIf="empresa">
                  <h6 *ngIf="empresa" class="titulo" style="font-size: 25px; text-align: center;">Empresa Seleccionada: {{empresa.nombreEmpresa}}</h6>
                </div>    
                <br>
                <button type="button" class="btn boton" (click)="c('')">Regresar</button> 
                &nbsp;&nbsp;&nbsp;&nbsp;
                <button *ngIf="empresa" (click)="asignarEmpresa()" (click)="c('')" type="button" class="btn boton" >Seleccionar Empresa</button> 
                <button *ngIf="!empresa" type="button" class="btn boton"  disabled>Seleccionar Empresa</button>  
            </div>
        </div>
    </ng-template>


    <ng-template #seleccionarPacienteNombreModal let-c="close" led-d="dismiss"> 
        <!-- Modal Header -->
        <div class="modal-header" style="color:white; background-color:#9AB638;">  
            <h4 style="text-align: center;">Seleccionar paciente</h4>  
            <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
            <form [formGroup]="pacienteBuscarForm" class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                <label>Por favor ingrese un nombre o apellido del paciente</label>
                <br>
                <input class="form-control" type="text" placeholder="Buscar" formControlName="nombre" [(ngModel)]="pacienteBuscar">
                <span style="color:Red;" *ngIf="pacienteBuscarForm.controls['nombre'].errors?.minlength">Debe ser mayor a 3 caracteres</span>
                <span style="color:Red;" *ngIf="pacienteBuscarForm.controls['nombre'].errors?.maxlength">No debe ser mayor a 30 caracteres</span>
                <span style="color:Red;" *ngIf="pacienteBuscarForm.controls['nombre'].touched && pacienteBuscarForm.controls['nombre'].errors?.required">Requerido.</span>
                <br *ngIf="pacienteBuscarForm.controls['nombre'].errors?.pattern">
                <span style="color:Red;" *ngIf="pacienteBuscarForm.controls['nombre'].errors?.pattern">No válido</span>
            </form>
            <br>
            <button type="button" class="btn boton" (click)="c('')">Regresar</button>
            &nbsp;&nbsp;&nbsp;&nbsp;
            <button *ngIf="estudioEstatus==0" style="font-size: 20px;" type="button" [disabled]="pacienteBuscarForm.invalid" (click)="c('')" (click)="buscarPacienteName()" (click)="verEstudios(seleccionarPacienteModal)" class="btn boton">Buscar</button>
        </div>
    </ng-template>


    <ng-template #seleccionarPacienteModal let-c="close" led-d="dismiss"> 
        <!-- Modal Header -->
        <div class="modal-header" style="color:white; background-color:#9AB638;">  
            <h4 style="text-align: center;">Selecciona paciente</h4>  
            <button type="button" class="close" style="color:white;" (click)="c('')">x</button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
            <div *ngIf="pacientesSearch">
                <table id="listaPacientesSearch" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%" >
                    <thead>
                    <tr>
                        <th>Expediente</th>
                        <th>Paciente</th>
                        <th>sexo</th>
                        <th>Fecha Nacimiento</th>
                        <th>Email</th>
                        <th>Celular</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let results of pacientesSearch.results; index as i" (click)="seleccionarPacienteSearch(results)" > 
                        <td *ngIf="!results.numExpediente"><span >{{results.numExpediente}}</span></td>
                        <td *ngIf="results.numExpediente"><span ></span></td>
                        <td ><span >{{results.nombre}} {{results.apellido_paterno}} {{results.apellido_materno}}</span></td>
                        <td *ngIf="results.sexo"><span >{{results.sexo}}</span></td>
                        <td *ngIf="!results.sexo"><span ></span></td>
                        <td *ngIf="results.fecha_nacimiento"><span >{{results.fecha_nacimiento}}</span></td>
                        <td *ngIf="!results.fecha_nacimiento"><span ></span></td>
                        <td *ngIf="results.email"><span ></span>{{results.email}}</td>
                        <td *ngIf="!results.email"><span ></span></td>
                        <td *ngIf="results.telefonoCelular"><span >{{results.telefonoCelular}}</span></td>
                        <td *ngIf="!results.telefonoCelular"><span ></span></td>
                    </tr>
                    </tbody> 
                </table>
            </div>
            <br *ngIf="pacienteSearchName">
            <h6 *ngIf="pacienteSearchName" class="titulo" style="font-size: 25px; text-align: center;">Paciente Seleccionado: {{pacienteSearchName.nombre}} {{pacienteSearchName.apellido_paterno}} {{pacienteSearchName.apellido_materno}}</h6>
            <br *ngIf="pacienteSearchName">
            <button type="button" class="btn boton" (click)="c('')">Regresar</button> 
            &nbsp;&nbsp;&nbsp;&nbsp;
            <button *ngIf="pacienteSearchName" (click)="seleccionarSearchPaciente()" (click)="c('')" type="button" class="btn boton" >Seleccionar Paciente</button> 
            <button *ngIf="!pacienteSearchName" type="button" class="btn boton" disabled>Seleccionar Paciente</button>  
        </div>
    </ng-template>